ReadSpeaker.Common.Settings=function(){var a={form:{key:"data-rsform-key",prev:"data-rsform-prev",valyes:"data-rsform-trueval",valno:"data-rsform-falseval"}},b={},c=function(a){return rspkr.Common.cookie.readKey(rspkr.pub.Config.item("general.cookieName"),a)||rspkr.pub.Config.item("settings."+a)},h=function(a,e){var b=c(a);if(e!=b){var f=rspkr.c.cookie.updateKey(rspkr.cfg.item("general.cookieName"),a,e);rspkr.cfg.item("settings."+a,e);rspkr.devt("onSettingsChanged",window,[a,e,b]);return f}return null},
e={controls:{xp:function(a){return rspkr.st.r().expandPhrase(a)},helpButton:'<img src="'+rspkr.baseUrl+'img/help.png" alt="" border="0" />',select:function(k,e,b,f){var g=[],c="hl"!==k?!1:rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang);g.push('<label for="',f,'">',this.xp(e.phrase),"</label>");g.push('<select id="',f,'" name="',f,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',k,'">');for(var l=0,h=e.options.length;l<h;l++)"hl"===k&&c&&!/\bsent|none/i.test(e.options[l].value)||("hl"===
k&&(c&&"sent"===e.options[l].value&&"none"!==b)&&(b="sent"),g.push('<option value="',e.options[l].value,'"',b==e.options[l].value?' selected="selected"':"",e.options[l].dims?' data-rsform-dims="'+e.options[l].dims.join(",")+'"':"",e.options[l].hides?' data-rsform-hides="'+e.options[l].hides.join(",")+'"':"",">",this.xp(e.options[l].phrase),"</option>"));g.push("</select>");e.info&&(g.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',
this.xp("ph_help"),": ",this.xp(e.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&g.push("&rlm;"),g.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(e.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.select,context:rspkr.st.r().handlers,params:[f]});return g.join("")},checkbox:function(k,e,b,f){var g=
b==e.options.truevalue;rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.checkbox,context:rspkr.st.r().handlers,params:[f]});return['<label for="'+f+'">',this.xp(e.phrase),'</label><input type="checkbox" id="',f,'" name="',f,'"',g?' checked="checked"':"",a.form.valyes,'="',e.options.truevalue,'" ',a.form.valno,'="',e.options.falsevalue,'" ',a.form.prev,'="',b,'" ',a.form.key,'="',k,'" />'].join("")},radio:function(k,e,b,f){var g=[];g.push('<fieldset class="rsform-radio-label" aria-level="2">');
g.push("<legend>",this.xp(e.phrase));e.info&&(g.push('<button id="rstoggle_',f,'" type="button" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',this.xp("ph_help"),": ",this.xp(e.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&g.push("&rlm;"));g.push("</legend>");for(var c=0,l=e.options.length;c<l;c++)g.push('<input type="radio" id="',f,"_",c,'" name="',f,'" title="',this.xp(e.phrase),": ",this.xp(e.options[c].phrase),'" value="',e.options[c].value,
'"'),g.push(" ",a.form.prev,'="',b,'" ',a.form.key,'="',k,'"'),g.push(b==e.options[c].value?' checked="checked"':""),e.options[c].dims&&g.push(' data-rsform-dims="',e.options[c].dims.join(","),'"'),g.push(" />"),rspkr.cfg.item("custom.disablerlm")&&g.push("&lrm;"),g.push('<label for="',f,"_",c,'">',this.xp(e.options[c].phrase),"</label>");e.info&&(g.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(e.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,
context:rspkr.st.r().handlers,params:[f]}));g.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.radio,context:rspkr.st.r().handlers,params:[f,c]});return g.join("")},info:function(a,e){return['<div class="rsform-infotext">',this.xp(e.phrase),"</div>"].join("")},slider_h:function(k,e,j,f){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.slider_h,context:rspkr.st.r().handlers,params:[e,f,j]});b[f]=e;return['<span class="rsform-slider-label">',this.xp(e.phrase),'</span><div id="',
f,'" class="rsform-slider rsimg" ',a.form.key,'="',k,'" ',a.form.prev,'="',j,'"></div>'].join("")},colorpicker:function(k,e,b,f){var g=[];g.push('<fieldset class="rsform-colorlist-label" aria-level="2">');g.push("<legend>",this.xp(e.phrase));e.info&&(g.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',f,'" title="',this.xp("ph_help"),": ",this.xp(e.phrase),'">'+this.helpButton+"</button>"),rspkr.cfg.item("custom.disablerlm")&&g.push("&rlm;"));
g.push("</legend>");g.push('<ul id="',f,'" class="rsform-colorlist" ',a.form.prev,'="',b,'" ',a.form.key,'="',k,'">');for(var k=0,c=e.options.length;k<c;k++){g.push("<li",b==e.options[k].value?' class="rsform-colorlist-active"':"",">");g.push('<a href="javascript: void(0);"');g.push(b==e.options[k].value?' tabIndex="0"':' tabIndex="-1"');g.push(' title="'+this.xp(e.phrase)+": "+this.xp(e.options[k].phrase)+'"');g.push(' data-rsform-value="',e.options[k].value,'"');if("underline"==e.options[k].value||
"none"==e.options[k].value)g.push(' class="'),"underline"==e.options[k].value&&g.push("rsform-colorlist-style-underline "),"none"==e.options[k].value&&g.push("rsform-colorlist-style-none "),g.push('"');g.push(' role="button"');g.push('><span class="rsform-colorlist-box"');"#"==e.options[k].value.substr(0,1)&&g.push(' style="background: ',e.options[k].value,';"');g.push("></span>");g.push('<span class="rsform-colorlist-label');"underline"==e.options[k].value?g.push('" style="text-decoration: underline;'):
/#/.test(e.options[k].value)&&g.push(" rsform-colorlist-style-color");g.push('">',this.xp(e.options[k].phrase),"</span></a>");g.push("</li>")}g.push("</ul>");g.push('<div style="clear: both;"></div>');e.info&&(g.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(e.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));g.push("</fieldset>");rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.colorpicker,
context:rspkr.st.r().handlers,params:[f]});return g.join("")},restore:function(a,e,b,f){rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.restore,context:rspkr.st.r().handlers,params:[f]});return["<div>",this.xp(e.phrase),'</div><input type="button" id="',f,'" value="',this.xp("ph_"+a),'" class="rsform-button" role="button"></input>'].join("")},infobox:function(a,e,b,f){a=[];a.push('<label for="',f,'">',this.xp(e.phrase),"</label>");e.info&&(a.push('<button type="button" id="rstoggle_',f,'" class="rsform-info-toggle" data-rsform-toggles="rscontainer_',
f,'" title="',this.xp("ph_help"),": ",this.xp(e.phrase),'">'+this.helpButton+"</button>"),a.push('<div id="rscontainer_',f,'" class="rsform-info-container" aria-live="polite">',this.xp(e.info),"</div>"),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.info,context:rspkr.st.r().handlers,params:[f]}));return a.join("")}},handlers:{info:function(a){$rs.regEvent($rs.get("#rstoggle_"+a),"click",this.changed.info)},select:function(a){$rs.regEvent($rs.get("#"+a),"change",this.changed.select)},checkbox:function(a){$rs.regEvent($rs.get("#"+
a),"click",this.changed.checkbox)},radio:function(a,e){for(var b=0;b<e;b++)$rs.regEvent($rs.get("#"+a+"_"+b),"click",this.changed.radio)},slider_h:function(a,e,b){var f=new ReadSpeaker.ui.Slider,g={};if(a.options)for(var c in a.options)a.options.hasOwnProperty(c)&&(g[c]=rspkr.st.r().expandPhrase(a.options[c]));g.initval=a.converter?a.converter(b):b||0;g.start=function(){};g.drop=this.changed.slider_h;f.init($rs.get("#"+e),g)},colorpicker:function(a){$rs.regEvent("#"+a+" li a","keydown",function(a){var e=
$rs.closest(this,"li"),k;37==a.keyCode?k=e.previousSibling:39==a.keyCode&&(k=e.nextSibling);k&&(a=$rs.findIn(k,"a"),a.focus(),a.click());return!0});$rs.regEvent("#"+a+" li a","click",this.changed.colorpicker);$rs.css($rs.get("#"+a),"display","block")},restore:function(a){$rs.regEvent("#"+a,"click",function(){if(rs.cfg.defaultsettings){for(var a in rs.cfg.defaultsettings)if(rs.cfg.defaultsettings.hasOwnProperty(a)){var e=rs.cfg.defaultsettings[a];rspkr.st.r().handlers.updateSetting(a,e);var k=$rs.get("input[value='"+
e+"']");if($rs.isArray(k))if(k=$rs.get("select[data-rsform-key='"+a+"']"),$rs.isArray(k)){if(k=$rs.get("ul[data-rsform-key='"+a+"']"),!$rs.isArray(k)){var b=$rs.findIn(k,".rsform-colorlist-active");$rs.removeClass(b,"rsform-colorlist-active");e=$rs.findIn(k,"a[data-rsform-value='"+e+"']").parentNode;$rs.addClass(e,"rsform-colorlist-active")}}else k.value=e;else k.checked=!0}rspkr.Common.Settings.r().handlers.changed.afterdim()}})},changed:{dimmed:[],hidden:[],disable:function(a,e){var e=e||"dimmed",
b=$rs.findIn(a,"input, select, textarea, ul.rsform-colorlist");$rs.addClass(a,e);if("dimmed"==e)for(var f=0,g=b.length;f<g;f++)"ul"!=b[f].tagName.toLowerCase()&&(b[f].disabled=!0)},enable:function(a,e){var e=e||"dimmed",b=$rs.findIn(a,"input, select, textarea");$rs.removeClass(a,e);if("dimmed"==e)for(var f=0,g=b.length;f<g;f++)b[f].disabled=!1},add:function(a,e,b,f){a[e]||(a[e]=[]);for(var g=0,c=b.length;g<c;g++)this.disable($rs.get("#rscontrol_"+b[g]),f),a[e].push($rs.get("#rscontrol_"+b[g]))},release:function(a,
e,b){if(a[e]){for(var f=0,g=a[e].length;f<g;f++)this.enable(a[e][f],b);a[e]=[]}},dim:function(a,e){this.undim(a);this.add(this.dimmed,a,$rs.isArray(e)?e:[e],"dimmed")},undim:function(a){this.release(this.dimmed,a,"dimmed")},afterdim:function(){for(var a=$rs.get("#rslightbox_content .rsform-row"),e,b=0,f=a.length;b<f;b++)e=$rs.getAttr(a[b],"data-rsform-type"),e=this.dimmees[e]?this.dimmees[e](a[b]):null,"string"==typeof e?this.dim(a[b].id.replace("rscontrol_",""),e.split(",")):1===e&&this.undim(a[b].id.replace("rscontrol_",
""))},addButtonEvents:function(a){$rs.regEvent($rs.get("#rslightbox_buttons .rssettings-button-close"),"click",a.hide)},dimmees:{radio:function(a){for(var a=$rs.findIn(a,'input[type="radio"]'),e,b=!1,f=0,g=a.length;f<g;f++)if(a[f].checked){e=a[f];break}e&&(b=$rs.getAttr(e,"data-rsform-dims")||1);return b},select:function(a){for(var a=$rs.findIn(a,"option"),e,b=!1,f=0,g=a.length;f<g;f++)if(a[f].selected){e=a[f];break}e&&(b=$rs.getAttr(e,"data-rsform-dims")||1);return b}},info:function(a){!$rs.hasClass(a.target.parentNode,
"dimmed")&&!$rs.hasClass(a.target.parentNode.parentNode,"dimmed")&&(a=$rs.get("#"+$rs.getAttr(this,"data-rsform-toggles")),$rs.css(a,"display","none"==$rs.css(a,"display")?"block":"none"));return!1},select:function(){this.value!==$rs.getAttr(this,a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]);return!0},checkbox:function(){var e=this.checked?$rs.getAttr(this,a.form.valyes):$rs.getAttr(this,a.form.valno);e!==$rs.getAttr(this,
a.form.prev)&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),e,this]);return!0},radio:function(){this.value!==$rs.getAttr(this,a.form.prev)&&(rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(this,a.form.key),this.value,this]),$rs.setAttr($rs.findIn(this.parentNode,'input[name="'+this.name+'"]'),a.form.prev,this.value));return!0},slider_h:function(e,p){var j=p.parent,f=b[p.rsid],f=f.converter?f.converter(parseInt(e)):parseInt(e),
g=$rs.getAttr(j,a.form.prev);f!==g&&rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(j,a.form.key),f,j])},colorpicker:function(e){e.originalEvent&&e.originalEvent.preventDefault&&e.originalEvent.preventDefault();var b=e.target.parentNode.parentNode,j=e.target.parentNode;if(!$rs.hasClass(e.target.parentNode.parentNode.parentNode,"dimmed")&&$rs.getAttr(e.target,"data-rsform-value")!==$rs.getAttr(b,a.form.prev)){$rs.removeClass($rs.findIn(b,"li"),"rsform-colorlist-active");
rspkr.st.r().handlers.updateSetting.apply(rspkr.st.r().handlers,[$rs.getAttr(b,a.form.key),$rs.getAttr(e.target,"data-rsform-value"),b]);$rs.addClass(j,"rsform-colorlist-active");for(var b=$rs.findIn(b,"a"),j=0,f;f=b[j];j++)$rs.setAttr(f,"tabIndex","-1");$rs.setAttr(e.target,"tabIndex",0)}}},updateSetting:function(e,b,j){rspkr.log("[rspkr.st] Setting updated: "+e+" | New value: "+b);h(e,b);if(j){var e=$rs.closest(j,".rsform-row"),f=$rs.css(e,"background-color");rspkr.u.hl(e,function(){$rs.css(this,
"background-color",f)});$rs.setAttr($rs.get(j),a.form.prev,b)}}},expandPhrase:function(a){if("string"==typeof a&&"ph_"==a.substr(0,3)){var a=a.substr(3),e=rspkr.cfg.getPhrase(a);return void 0!==e?e:a}return a},row:function(a,e,b){if(/hlword|hltoggle/i.test(a)&&rspkr.cfg.isSentOnly&&rspkr.cfg.isSentOnly(rspkr.c.data.params.lang))return"";var f=rspkr.cfg.item("ui.settings.formrow").join("\n"),g={},c=ReadSpeaker.getID(),b=this.controls[e.type](a,e,b,c);g.rsCONTROL_IDrs=a;g.rsCONTROLrs=b;g.rsCONTROL_TYPErs=
e.type;g.rsCONTROL_CLASSESrs=e.classes?e.classes.join(" "):"";return this.replaceTokens(f,g)},group:function(a){var e=rspkr.cfg.item("ui.settings.formsection").join("\n"),b={},f=[],g;for(g in a.items)a.items.hasOwnProperty(g)&&f.push(this.row(g,a.items[g],c(g)));b.rsSECTION_IDrs=ReadSpeaker.getID();b.rsSECTION_HEADINGrs=this.controls.xp(a.phrase);b.rsSECTION_ROWSrs=f.join("\n");return this.replaceTokens(e,b)},replaceTokens:function(a,e){var b=a,f;for(f in e)e.hasOwnProperty(f)&&(b=b.replace(RegExp(f,
"igm"),e[f]));return b}};return{meta:{revision:"5565"},r:function(){return e},e:a,init:function(){for(var a=["ReadSpeakerHL","ReadSpeakerHLicon","ReadSpeakerHLspeed"],e=!1,b=0,f=a.length;b<f;b++){var g=rspkr.Common.cookie.read(a[b]);g&&(rspkr.Common.cookie.updateKey(rspkr.pub.Config.item("general.cookieName"),a[b].substr(11).toLowerCase(),g),e=!0,rspkr.Common.cookie.erase(a[b]))}e&&rspkr.log("[rspkr.st] Transferred legacy cookie.");rspkr.Common.dispatchEvent("onSettingsInitialized");rspkr.log("[rspkr.st] Initialized!");
rspkr.Common.addEvent("onSettingsLoaded",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]});rspkr.Common.addEvent("onSettingsChanged",{func:rspkr.Common.Settings.r().handlers.changed.afterdim,context:rspkr.Common.Settings.r().handlers.changed,params:[]})},get:function(a){return c(a)},getAll:function(){return rspkr.Common.cookie.readKeyAll(rspkr.pub.Config.item("general.cookieName"))},set:function(a,e){return h(a,e)},getHTML:function(){var a=
rspkr.cfg,b=[],c=a.item("ui.settings.form").join("\n"),f={},g=a.getSettingsConf(),h;for(h in g)g.hasOwnProperty(h)&&b.push(e.group(g[h]));g="";rspkr.ui.getActivePlayer()&&rspkr.cfg.item("ui.listenBtn")&&(g=document.createElement("div"),g.innerHTML=a.item("ui.listenBtn").join(""),a=rspkr.ui.getActivePlayer().getHref(),a=a.replace(/readid=[^&]+/gi,"readid=rslightbox_content"),a=a.replace(/&url=[^&]+/gi,""),$rs.setAttr($rs.findIn(g,".rsbtn_play"),"href",a),g=e.replaceTokens(g.innerHTML,{rsLISTENrs:e.controls.xp("ph_listen")}));
f.rsSETTINGS_HEADINGrs=e.controls.xp("ph_settings");f.rsLISTEN_BUTTONrs=rs.cfg.item("ui.settingsListenButton")&&"rsbtn"===rs.ui.rsbtnClass?g:"";f.rsSECTIONS_STARTrs="";f.rsSECTIONSrs=b.join("");f.rsSECTIONS_ENDrs="";return e.replaceTokens(c,f)},getButtons:function(){var a=rspkr.cfg.item("ui.settings.formbuttons").join("\n"),b={};b.rsSETTINGS_BUTTON_CLOSErs=e.controls.xp("ph_close");return e.replaceTokens(a,b)}}}();
ReadSpeaker.PlayerAPI=function(){var a={audioFormat:"flv",minver:8,check:function(){return rspkr.c.data.browser.flashVersion.split(",").shift()>=this.minver?!0:!1}},b={prioritize:!1,audioFormat:null,check:function(){return rspkr.c.data.browser.html5Support?(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0):!1}},c="",h=function(a,e){for(var b in e)a[b]=e[b]},e={meta:{revision:"5565"},init:function(){rspkr.log("[rspkr.pl] Initialized!");rspkr.Common.addEvent("onModsLoaded",
function(){rspkr.Common.Detect.init();rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){c=b.check()&&a.check()?b.prioritize?"html5":"flash":b.check()?"html5":a.check()?"flash":"fallback";"html5"==c?(rspkr.log("[rspkr.pl] Using adapter "+c,1),h(e,rspkr.pl.html5.adapter)):"flash"==c?(rspkr.log("[rspkr.pl] Using adapter "+c,1),h(e,rspkr.pl.flash.adapter)):(rspkr.log("[rspkr.pl] No adapter detected - using fallback!",3),h(e,rspkr.pl.fallback.adapter))},getProduct:function(){return ReadSpeaker.HL?
ReadSpeaker.HL:ReadSpeaker.XP?ReadSpeaker.XP:!1}};return e}();
ReadSpeaker.PlayerAPI.flash=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.flash heartbeat!")},adapter:{adapter:"flash",playerRef:null,timerCallBack:null,timerContext:null,loadTimer:null,progressStarted:!1,networkCheckCounter:0,play:function(){if(this.playerRef)try{this.playerRef.rs_player_play(),rspkr.devt("onAPIPlay",window)}catch(a){ReadSpeaker.log("error: "+a)}else this.initAdapter()},pause:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_pause(),rspkr.devt("onAPIPause",
window)}catch(a){rspkr.log("error: "+a,3)}},stop:function(){if(rspkr.pl.playerRef)try{this.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){rspkr.log("error: "+a,3)}},volUp:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_volup(),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_voldown(),rspkr.devt("onAPIVolumeDown",window))},mute:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_mute(),rspkr.devt("onAPIMute",window))},
forward:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpff(),rspkr.devt("onAPIFastForward",window))},rewind:function(){rspkr.pl.playerRef&&(this.playerRef.rs_player_jumpbb(),rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume]",4);rspkr.pl.playerRef&&(this.playerRef.setVolume?(this.playerRef.setVolume(a),rspkr.devt("onAPISetVolume",window)):window.setTimeout(function(){rspkr.pl.setVolume(a)},10))},setProgress:function(a){if(rspkr.pl.playerRef)try{this.playerRef.setProgress(a),
rspkr.devt("onAPISetProgress",window)}catch(b){}},getProgress:function(a,b,c){rspkr.pl.playerRef&&(this.timerCallBack=b,this.timerContext=c||b,rspkr.pl.playerRef&&"function"==typeof rspkr.pl.playerRef.getProgress?(clearTimeout(this.loadTimer),rspkr.pl.playerRef.getProgress(a,"rspkr.pl.timer",500),this.progressStarted=!0):this.progressStarted||(this.loadTimer=window.setTimeout(function(){rspkr.pl.getProgress(a,b,c)},500)),rspkr.devt("onAPIGetProgress",window))},timer:function(a){a=a.split("|");if("function"==
typeof this.timerCallBack)try{this.timerCallBack.apply(this.timerContext,[a])}catch(b){}},checkNetworkStatus:function(){3<rspkr.pl.networkCheckCounter||setTimeout(function(){if(rspkr.pl.playerRef){rspkr.pl.networkCheckCounter++;try{rspkr.log("[rspkr.pl.checkNetworkStatus] "+rspkr.pl.playerRef.rs_player_networkStatus(),1)}catch(a){rs.pl.checkNetworkStatus();return}3===rspkr.pl.playerRef.rs_player_networkStatus()?(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",
window)):0===rs.PlayerAPI.playerRef.rs_player_networkStatus()&&rs.pl.checkNetworkStatus()}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){var a=encodeURIComponent(rspkr.c.data.getAudioLink({audioformat:"flv"}));this.progressStarted=!1;this.releaseAdapter();var b=document.getElementById("rs_player_holder");b||(b=document.createElement("div"),$rs.setAttr(b,"id","rs_player_holder"),document.body.appendChild(b));a=['<object id="readspeaker_flash_player" '+(document.selection?'classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"':
'type="application/x-shockwave-flash" data="'+ReadSpeaker.pub.Config.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" ')+'style="height: 1px; width: 1px;">','<param name="movie" value="'+rspkr.cfg.item("flash.flashSrc")+"?flv="+a+'&autoplay=1" />','<param name="quality" value="high" />','<param name="autostart" value="true" />','<param name="allowScriptAccess" value="'+rspkr.cfg.item("flash.allowScriptAccess")+'" />','<param name="loop" value="false" /></object>'];b.innerHTML=a.join("\n");$rs.setAttr(b,
"style","position: fixed; bottom: 0px; right: 0px;");var c=function(a){4===a&&(rspkr.pl.playerRef&&rspkr.pl.playerRef.setVolume)&&(rspkr.pl.playerRef.setVolume(rspkr.st.get("hlvol")||"100"),document.attachEvent?$rs.get("#readspeaker_flash_player").detachEvent("onreadystatechange",c):document.addEventListener&&$rs.get("#readspeaker_flash_player").removeEventListener("load",function(){c(4)},!1))};document.attachEvent?($rs.get("#readspeaker_flash_player").attachEvent("onreadystatechange",c),rspkr.devt("onVolumeAdjusted",
window)):document.addEventListener&&$rs.get("#readspeaker_flash_player").addEventListener("load",function(){c(4)},!1);rspkr.pl.playerRef=document.getElementById("readspeaker_flash_player");rspkr.devt("onAPIInitAdapter",window);rspkr.pl.checkNetworkStatus()},releaseAdapter:function(){if(rspkr.pl.playerRef){try{rspkr.pl.playerRef.rs_player_stop(),rspkr.devt("onAPIStop",window)}catch(a){ReadSpeaker.log("error: "+a)}var b=$rs.get("#rs_player_holder");b.removeChild(rspkr.pl.playerRef);document.body.removeChild(b);
rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();
ReadSpeaker.PlayerAPI.html5=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:{adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,playbackStarted:!1,play:function(){ReadSpeaker.log("[rspkr.pl.play]");rspkr.HL.chunking.close();rspkr.HL.chunking.chunkEnded?(rspkr.HL.chunking.chunkEnded=!1,rspkr.c.dispatchEvent("onChunkResume",window)):!this.playerRef||rspkr.HL.newPlayback?(this.initAdapter(),rspkr.HL.newPlayback=!1):(rspkr.pl.playPromise(this.playerRef),
rspkr.devt("onAPIPlay",window))},mobilePause:function(a){!rspkr.pl.playbackStarted&&a.pause()},playPromise:function(a,b,c,h){rspkr.pl.playbackStarted=!h;var e=a.play();if(void 0!==e)e.then(function(){h?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0;!h&&(a.muted=!1);var e=rspkr.ui.getActivePlayer(),c=e?e.getContainer():void 0;e&&c&&($rs.hasClass(c,"rspaused")?(e.pause(),$rs.removeClass($rs.findIn(c,".rsbtn_progress_container"),"rsloading")):$rs.hasClass(c,"rsstopped")?e.stop():$rs.hasClass(c,"rsexpanded")||
e.close());b&&"function"===typeof b&&b.call()})["catch"](function(a){rspkr.log("PlayPromise error: "+a,3);c&&"function"===typeof c&&c.call(a)});else"function"===typeof b&&(h?rs.pl.mobilePause(a):rspkr.pl.playbackStarted=!0,b.call())},pause:function(){this.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0),rspkr.devt("onAPIStop",window))},volUp:function(){this.playerRef&&
(this.playerRef.volume=Math.min(1,this.playerRef.volume+0.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){this.playerRef&&(this.playerRef.volume=Math.max(0,this.playerRef.volume-0.2),rspkr.st.set("hlvol",100*this.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){this.playerRef&&(this.playerRef.volume=0,rspkr.devt("onAPIMute",window))},forward:function(){this.playerRef&&(this.playerRef.currentTime=this.playerRef.currentTime+
5<this.playerRef.duration?this.playerRef.currentTime+5:this.playerRef.duration,rspkr.devt("onAPIFastForward",window))},rewind:function(){this.playerRef&&(this.playerRef.currentTime=0<this.playerRef.currentTime-5?this.playerRef.currentTime-5:0,rspkr.devt("onAPIRewind",window))},setVolume:function(a){rspkr.log("[setVolume] "+a,4);this.playerRef&&(this.playerRef.volume=parseFloat(a/100),rspkr.devt("onAPISetVolume",window))},setProgress:function(a){if(this.playerRef){var a=parseInt(a),b=parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());
this.playerRef.currentTime=a<b&&a<this.playerRef.duration?a:this.playerRef.duration;rspkr.HL&&(rspkr.HL.html5&&rspkr.HL.html5.lastcurrenttime)&&(rspkr.HL.html5.lastcurrenttime=0);rspkr.devt("onAPISetProgress",window)}},getProgress:function(a,b,c){this.playerRef&&(!1==a?rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1):(this.timerCallBack=b,this.timerContext=c||b,rspkr.pl.playerRef.addEventListener("timeupdate",rspkr.pl.timer,!1),rspkr.devt("onAPIGetProgress",window)))},timer:function(){if(rspkr.pl.playerRef){var a=
1E3*parseInt(rspkr.pl.playerRef.currentTime);rspkr.pl.bufferedTime=1E3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());var b=[a,rspkr.pl.bufferedTime];if(rspkr.hl.html5&&rspkr.hl.html5.synclist&&rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1]){var c=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1][0];rspkr.pl.bufferedTime>c&&(b=[a,c])}if("function"==typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[b])}catch(h){rspkr.log("timeupdate error",
2)}}},checkNetworkStatus:function(){var a=rs.pl.playerRef;rs.pl.errorCount=rs.pl.errorCount||0;rs.pl.networkStates=rs.pl.networkStates||[0,0,0,0];setTimeout(function(){if(a){rs.pl.networkStates[a.networkState]++;rs.pl.networkStates[4]=a.buffered&&a.buffered.length&&0<a.buffered.end(0)?a.buffered.end(0):!1;rs.pl.networkStates[5]=a.duration&&a.duration&&!isNaN(a.duration)&&0<a.duration?a.duration:!1;if(3===a.networkState)rs.pl.errorCount++,10<rs.pl.errorCount&&!rs.pl.networkStates[4]&&!rs.pl.networkStates[5]?
(rspkr.log("[rspkr.pl] Cannot load audio!",3),rspkr.ui.showOverlay("loaderror"),rspkr.devt("onAudioLoadError",window)):rspkr.pl.checkNetworkStatus();else if(2===a.networkState){rs.pl.errorCount=0;var b=0<a.buffered.length?a.buffered.end(a.buffered.length-1):0,c=a.duration||0;(0==c||b<c)&&rspkr.pl.checkNetworkStatus()}else rs.pl.errorCount=0;rspkr.log(rs.pl.networkStates,5)}},rspkr.cfg.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();
try{0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0)}catch(a){}rspkr.pl.playerRef=null;rspkr.devt("onAPIReleaseAdapter",window)}},reloadAdapter:function(){this.releaseAdapter();this.initAdapter();rspkr.devt("onAPIReloadAdapter",window)}}}}();rspkr.PlayerAPI.fallback=function(){return{init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:{adapter:"fallback"}}}();
rspkr.HL=function(){var a="",b={firstRun:0,previousWord:{},previousSent:{},lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[]},c={oldWordHL:[],oldWordHLClass:[],oldSentHL:[],oldSentHLClass:[],sync:function(a,b){var c=!1,j=document.getElementById("sync"+b);0==(a&2)&&(c=0!=(a&1)?!0:!1);if(j){if(j&&j.className.replace("word","")!=j.className){if(!c&&0<this.oldWordHL.length){for(c=0;c<this.oldWordHLClass.length;c++)this.oldWordHL[c].className=this.oldWordHLClass[c];this.oldWordHL=
[];this.oldWordHLClass=[]}this.oldWordHLClass.push(j.className);this.oldWordHL.push(j);rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(j,a);j.className=j.className.replace("sync_word","sync_word_highlighted")}else if(j&&j.className.replace("sent","")!=j.className){if(!c&&0<this.oldSentHL.length){for(c=0;c<this.oldSentHL.length;c++)this.oldSentHL[c].className=this.oldSentHLClass[c];this.oldSentHL=[];this.oldSentHLClass=[]}this.oldSentHLClass.push(j.className);this.oldSentHL.push(j);
rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(j,a);j.className=j.className.replace("sync_sent","sync_sent_highlighted")}j&&rspkr.HL.Scroll.execScroll(j)}},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var a=rspkr.Common.data.getParam("readid"),a=document.getElementById(a).innerHTML;rspkr.Common.data.setRestoreContent(a)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!");
rspkr.HL.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var a=rspkr.HL.serverMarkup.oldWordHL,b=rspkr.HL.serverMarkup.oldWordHLClass,c=rspkr.HL.serverMarkup.oldSentHL,j=rspkr.HL.serverMarkup.oldSentHLClass;if(a&&0<a.length){for(var f=0;f<a.length;f++)a[f].className=b[f];rspkr.HL.serverMarkup.oldWordHL=[];rspkr.HL.serverMarkup.oldWordHLClass=[]}if(c&&0<c.length){for(f=0;f<c.length;f++)c[f].className=j[f];rspkr.HL.serverMarkup.oldSentHL=[];rspkr.HL.serverMarkup.oldSentHLClass=
[]}f=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1");a=$rs.get(f+".sync_sent,"+f+".sync_word,"+f+".sync_sent_highlighted,"+f+".sync_word_highlighted,"+f+".sync_user,"+f+".synctemp,"+f+'[class*="ffsent"]');a=$rs.isArray(a)?a:[a];for(f=a.length-1;-1<f;f--)a[f].className=a[f].className.replace("sync_sent_highlighted","sync_sent"),a[f].className=a[f].className.replace("sync_word_highlighted","sync_word"),-1!==a[f].className.toLowerCase().indexOf("sync_user")&&(a[f].className=
a[f].className.replace("sync_sent",""),a[f].className=a[f].className.replace("sync_word",""),a[f].removeAttribute("id"))}}},h={enums:{key:"readspeaker_inline_styles",sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var a=rspkr.pub.Config,b=rspkr.Common.Settings.get("hlword")||a.item("settings.hlword"),c=rspkr.Common.Settings.get("hlsent")||a.item("settings.hlsent"),a=rspkr.Common.Settings.get("hltext")||
a.item("settings.hltext");this.updateHL("hlword",b,null);this.updateHL("hlsent",c,null);this.updateHL("hltext",a,null)},updateHL:function(e,k,c){c=c||null;"hlspeed"===e&&k!==c&&(this.hlChanged=!0);if(k!==c&&("hl"===e||"hltoggle"===e))this.hlChanged=!0,rspkr.HL.sync.lightCleanUp();if(k!==c&&("hl"===e&&"none"!==k||"hltoggle"===e&&"hlon"===k))this.setTextStyle("word",rspkr.Common.Settings.get("hlword")),this.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),this.setTextStyle("hltext",rspkr.Common.Settings.get("hltext")),
this.hlChanged=!0,rspkr.HL.Type.CURRENT===rspkr.HL.Type.CLIENT_MARKUP&&rspkr.PlayerAPI.releaseAdapter();/hltext|hlword|hlsent|hlscroll/i.test(e)&&k!=c&&("hlscroll"==e?rspkr.HL.Scroll.initScroll():(this.setTextStyle(e,k),"explorer"==a&&(b.selectionRange&&("wordsent"===rspkr.st.get("hl")&&"hlsent"==e)&&(b.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),b.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))),b.lastWord&&("sent"==rspkr.st.get("hl")?
b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")):b.lastWord.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")),b.lastWord.execCommand("forecolor",0,rspkr.Common.Settings.get("settings.hltext"))))))},setTextStyle:function(a,b,c){var j=/word/.test(a)?"word":"sent",f="background-color",c=c||h.enums.key;/underline/.test(b)?(f="text-decoration",b+=" !important; background-color: none !important"):/none/.test(b)?(f="background",b+=" !important; text-decoration: none !important; background-color: none !important"):
"hltext"===a?(a=b,b=this.getStyleString(rspkr.Common.Settings.get("hlsent"),a),a=this.getStyleString(rspkr.Common.Settings.get("hlword"),a),rspkr.Common.css.replaceRule(c,"."+h.enums.word_hl,f+": "+a)):b+=" !important; text-decoration: none !important; color: "+rspkr.Common.Settings.get("hltext")+" !important";rspkr.Common.css.replaceRule(c,"."+h.enums[j+"_hl"],f+": "+b)},getStyleString:function(a,b){var c=/underline|none/i.test(a)?"none":a,j=/underline/i.test(a)?"underline":"none";return c+" !important; text-decoration: "+
j+" !important; color: "+b+" !important"}};return{meta:{revision:"5565"},init:function(){var e=rspkr.Common.addEvent;e("onAfterModsLoaded",function(){e("onAPIInitAdapter",rspkr.HL.Restore.setRestoreContent);rspkr.HL.addEvents();rspkr.HL.Scroll.initScroll();a=document.selection&&(9>rspkr.Common.data.browser.version||9>document.documentMode)?"explorer":"gecko";rspkr.log("[rspkr.hl] Using engine "+a);var k=rspkr.HL.engine[a].clientExtension,f;for(f in k)b[f]=k[f];window.addEventListener&&window.addEventListener("message",
rspkr.HL.html5.receiveMessage,!1,!0)});e("onModsLoaded",{func:h.setHL,context:h});e("onSettingsChanged",{func:h.updateHL,context:h});var k=rspkr.HL,c=document.createElement("audio");k.chunking={html5support:!!c.canPlayType,close:function(){var a=$rs.get(".rsresume");$rs.isArray(a)||(a=[a]);for(var e=0,b;b=a[e];e++)b.parentElement.removeChild(b)},silence:function(){rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.src&&(rspkr.HL.chunking.entracte.pause(),rspkr.HL.chunking.entracte.currentTime&&
(rspkr.HL.chunking.entracte.currentTime=0))},kill:function(){rspkr.HL.chunking.timer&&clearTimeout(rspkr.HL.chunking.timer);rspkr.HL.chunking.continueHref=null;rspkr.HL.chunking.stall=null;rspkr.HL.chunking.chunkEnded=null;rspkr.HL.chunking.currentChunkNumber=1;rspkr.HL.chunking.entracte&&rspkr.HL.chunking.entracte.removeAttribute("src")},destroy:function(){rspkr.HL.chunking.silence();rspkr.HL.chunking.close();rspkr.HL.chunking.kill()}};rspkr.HL.chunking.currentChunkNumber=1;e("onChunkResume",function(){if(rspkr.HL.chunking.continueHref){rspkr.HL.chunking.silence();
var a=rspkr.ui.getActivePlayer().getContainer();if($rs.hasClass(a,"rsautopaused")||!$rs.hasClass(a,"rspaused"))if(rspkr.HL.chunking.stall)setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},250);else{$rs.removeClass(a,"rsautopaused");clearTimeout(rspkr.HL.chunking.timer);var a=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}",rspkr.Common.data.browser.html5AudioFormat),e=rspkr.HL.chunking.continueHref.replace("%{AUDIOFORMAT}","html5iframe");rspkr.HL.chunking.continueHref=void 0;
rspkr.HL.html5.audioUrl=a.replace(/&amp;/g,"&");rspkr.HL.html5.frameUrl=e.replace(/&amp;/g,"&");rspkr.HL.html5.initSyncFrame();rspkr.HL.html5.initAudio();rspkr.ui.getActivePlayer().play();rspkr.HL.chunking.currentChunkNumber++}}});rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){rspkr.log("[rspkr.HL.addEvents]");var a=rspkr.Common.addEvent;a("onUIClosePlayer",rspkr.HL.sync.lightCleanUp);a("onUIClosePlayer",rspkr.HL.cleanUpHandler);a("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)});
a("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)});a("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()});rspkr.PlayerAPI&&(rspkr.PlayerAPI.adapter&&"html5"===rspkr.PlayerAPI.adapter)&&(rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",
rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release));rspkr.evt("onAPIStop",rspkr.HL.sync.lightCleanUp)},cleanUpHandler:function(a){rspkr.log("[rspkr.HL.cleanUpHandler] String is: "+a);"userclick"===a||"nosel"===a?rspkr.HL.sync.fullCleanUp():rspkr.HL.sync.lightCleanUp()},clientMarkup:b,serverMarkup:c,markedUpHTML:[],html5:{States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(a){this.CURRENT=
a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){rspkr.log("onCanPlay fired!",1);this.canPlay=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500);return!1},checkCompletion:function(){this.canPlay&&(this.durationChange&&
this.syncReady)&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1);this.durationChange=!0;this.checkCompletion();this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",1);this.syncReady=!0;this.checkCompletion();
this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1);rspkr.hl.html5.Events.resetAll();rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.syncReady=this.durationChange=this.canPlay=!1},onEnded:function(){rs.HL.chunking.continueHref?window.rshlcontinue():window.rshlexit("false")}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,backupUrl:null,frameUrl:null,
timer:null,postMessageData:[],runningRefresh:!1,handlers:{init:function(){rspkr.log("[rspkr.HL.html5.handlers.init]");rspkr.HL.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]};rspkr.HL.html5.rshlendCall=!1;var a=Math.random(),b={};b.audioformat=rspkr.Common.data.browser.html5AudioFormat;b.requestgrouptype="html5iframe";b.requestgroup=a;b.chunk=1;rspkr.HL.html5.backupUrl=rspkr.Common.data.getAudioLink(b);(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||
0<rspkr.Common.data.selectedHTML.length)&&"iOS"!==rspkr.Common.data.browser.OS&&"Android"!==rspkr.Common.data.browser.OS&&"Windows Phone"!==rspkr.Common.data.browser.OS?rspkr.HL.html5.timer=setTimeout(function(){rspkr.HL.html5.initSyncFrame(b);rspkr.HL.html5.initAudio();clearTimeout(rspkr.HL.html5.timer)},2E3):(rspkr.log("Normal audio init!"),rspkr.HL.html5.initSyncFrame(b),rspkr.HL.html5.initAudio())},play:function(){rspkr.log("[rspkr.HL.html5.handlers.play]");rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&
rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT==rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.HL.html5.handlers.runPostMessages()):
(rspkr.hl.html5.States.CURRENT=rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.HL.html5.handlers.release]");rspkr.HL.html5.synclist=[];rspkr.HL.html5.synclistindex=0;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.audioUrl=null;rspkr.HL.html5.backupUrl=null;rspkr.HL.html5.frameUrl=null;rspkr.HL.html5.postMessageData=
[];rspkr.HL.html5.Events.resetAll();rspkr.PlayerAPI.playerRef&&rspkr.PlayerAPI.playerRef.removeEventListener("ended",rshlexit,!1);rspkr.PlayerAPI.playerRef=null;var a=document.getElementById("ReadSpeaker_sync_iframe");a&&(a.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED);rspkr.HL.html5.lastcurrenttime=-1;rspkr.HL.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.HL.html5.handlers.updateTime]");rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING);
rspkr.HL.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime;rspkr.HL.html5.currentsyncindex=0;rspkr.HL.html5.handlers.setCurrentSyncIndex();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.runPostMessages]");var a=rspkr.HL.html5.postMessageData,b;for(b in a)null!==a[b-1]&&"rshlsetContent"==a[b]?rspkr.HL.sync.setContent(rspkr.Common.base64.decode(a[b-1])):null!==a[b-1]&&"rshlsetId"==a[b]?rspkr.HL.sync.setId(a[b-
1]):"rshlinit"==a[b]&&(rspkr.HL.sync.init(),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef),rspkr.HL.html5.refresh())},clearPostMessages:function(){rspkr.log("[rspkr.HL.html5.handlers.clearPostMessages]");rspkr.HL.html5.postMessageData=[]},setCurrentSyncIndex:function(){if(0<rspkr.HL.html5.synclist.length&&rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex])for(;rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex]&&20>=1*rspkr.HL.html5.synclist[rspkr.HL.html5.currentsyncindex][0]-1E3*rspkr.PlayerAPI.playerRef.currentTime;)rspkr.HL.html5.currentsyncindex++},
totalTime:function(){var a=rspkr.PlayerAPI.playerRef;if(a)if("Opera"!==rspkr.Common.data.browser.name&&a.buffered&&a.buffered.end)try{return 0<a.buffered.length?a.buffered.end(a.buffered.length-1):a.buffered.end(0)}catch(b){return a.duration&&"infinity"!==a.duration.toString().toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}else return a.duration&&"infinity"!==a.duration.toString.toLowerCase()&&"NaN"!==a.duration?a.duration:a.currentTime+15}},initAudio:function(){if(!rspkr.HL.html5.audioUrl||
rspkr.HL.newPlayback)rspkr.HL.html5.audioUrl=rspkr.HL.html5.backupUrl;rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.HL.html5.audioUrl,1);(/windows phone|ios|android/i.test(rspkr.c.data.browser.OS)||/safari/i.test(rspkr.c.data.browser.name))&&"object"===typeof window.rspkr.audio&&null!==window.rspkr.audio?(rspkr.audio.src=rspkr.HL.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rs.hl.initAudio] Reusing existing audio element.",4)):rspkr.PlayerAPI.playerRef=new Audio(rspkr.HL.html5.audioUrl);
var a=rspkr.PlayerAPI.playerRef;a.loop=!1;a.preload="auto";a.volume=parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.devt("onVolumeAdjusted",window);(/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)||/safari/i.test(rspkr.c.data.browser.name))&&rspkr.pl.playPromise(rspkr.pl.playerRef,void 0,void 0,!0);a.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1);a.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",
1);1==rspkr.HL.html5.handlers.totalTime()&&!0==rspkr.PlayerAPI.playerRef.paused?rspkr.HL.html5.initAudio():(0===rspkr.HL.html5.handlers.totalTime()&&rspkr.pl.playPromise(rspkr.pl.playerRef),rspkr.hl.html5.Events.onDurationChange())},!1);rspkr.pl.checkNetworkStatus();rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(a){if("none"!=rspkr.Common.data.sync){var b=null;document.getElementById("ReadSpeaker_sync_iframe")?b=document.getElementById("ReadSpeaker_sync_iframe"):
(b=document.createElement("iframe"),b.setAttribute("id","ReadSpeaker_sync_iframe"),b.setAttribute("title","ReadSpeaker_sync_iframe"),b.setAttribute("aria-hidden","true"),b.setAttribute("sandbox","allow-same-origin allow-scripts"),b.height=0,b.width=0,b.style.display="none",document.body.appendChild(b));!rspkr.HL.html5.frameUrl&&(!0===rspkr.cfg.item("general.usePost")||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)?rspkr.HL.html5.frameUrl=rspkr.HL.html5.backupUrl+
"sync":rspkr.HL.html5.frameUrl||(a.audioformat="html5iframe",rspkr.HL.html5.frameUrl=rspkr.Common.data.getAudioLink(a));rspkr.log("[rspkr.HL.html5.initSyncFrame] Audio URL: "+rspkr.HL.html5.frameUrl);rspkr.HL.html5.frameUrl&&(b.src=rspkr.HL.html5.frameUrl,b.type="text/javascript")}else rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.pl.playPromise(rspkr.pl.playerRef)},removeSyncFrame:function(){var a=document.getElementById("ReadSpeaker_sync_iframe");a&&a.parentNode.removeChild(a)},
receiveMessage:function(a){var b=!0;rspkr.cfg.item("general.servercall")&&(b=document.createElement("a"),$rs.setAttr(b,"href",rspkr.cfg.item("general.servercall")),b=!a.origin.match(b.hostname));var c=document.createElement("a");c.href=a.origin;var c=c.hostname,j=["\\.readspeaker\\.com$","^79\\.136\\.80\\.([0-9][0-9]?[0-9?])$","^173\\.205\\.5\\.(19[3-9]|2[0-4][0-9]|25[0-4])$","^2001\\:668\\:1F\\:2A","^2001\\:9b0\\:2\\:703","\\."+rspkr.cfg.item("general.domain").replace(".","\\\\.")+"$"],j=RegExp("("+
j.join("|")+")","gi");!c.match(j)&&b||"string"!==typeof a.data||rspkr.HL.html5.parseMessage(a)},parseMessage:function(a){rspkr.HL.html5.postMessageData.push(a.data);!/android|ios|windows phone/i.test(rspkr.Common.data.browser.OS)&&"rshlfinished"==a.data&&(rspkr.HL.html5.timer&&clearTimeout(rspkr.HL.html5.timer),rspkr.HL.html5.initSyncFrame(),rspkr.HL.html5.initAudio());if("rshlend"===a.data)rspkr.hl.html5.lastevent&&(rspkr.hl.html5.lastevent.data&&!isNaN(rspkr.hl.html5.lastevent.data))&&(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=
[rspkr.HL.html5.lastevent.data,"rshlend",0],rspkr.HL.html5.synclistindex++),rspkr.HL.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.HL.html5.removeSyncFrame();else{if("rshlaudio"===a.data){a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(rspkr.HL.html5.lastevent.data):rspkr.HL.html5.lastevent.data;rspkr.HL.html5.audioUrl=a;return}if("rshlhtml5sync"===a.data){var a=rspkr.HL.html5.lastevent.data,b=document.createElement("a");b.href=a;if("http:"!==b.protocol&&
"https:"!==b.protocol)return;a=rs.cfg.item("general.customProxy")?rs.cfg.item("general.customProxy")+encodeURIComponent(a):a;rspkr.HL.html5.frameUrl=a;return}if("rshlaudio"==a.data)return;null!=rspkr.HL.html5.lastevent&&"rshlsetContent"==a.data?(rspkr.HL.html5.synclist=[],rspkr.HL.html5.synclistindex=0,rspkr.HL.sync.setContent(rspkr.Common.base64.decode(rspkr.HL.html5.lastevent.data))):null!=rspkr.HL.html5.lastevent&&"rshlsetId"==a.data?rspkr.HL.sync.setId(rspkr.HL.html5.lastevent.data):null!=rspkr.HL.html5.lastevent&&
"rshlReplace"==a.data?(rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/class=[^&|,]+/gi)[0].replace("class=",""),rspkr.HL.sync.setClass(b)),rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)&&(b=rspkr.HL.html5.lastevent.data.match(/id=[^&|,]+/gi)[0].replace("id=",""),rspkr.HL.sync.setId(b))):"rshlinit"==a.data?(rspkr.HL.sync.init(),rspkr.hl.html5.Events.onSyncReady()):null!=rspkr.HL.html5.lastlastlastevent&&null!=rspkr.HL.html5.lastlastevent&&null!=
rspkr.HL.html5.lastevent&&"rshlsync"==a.data?(rspkr.HL.html5.synclist[rspkr.HL.html5.synclistindex]=[rspkr.HL.html5.lastlastlastevent.data,rspkr.HL.html5.lastlastevent.data,rspkr.HL.html5.lastevent.data],rspkr.HL.html5.synclistindex++):null!=rspkr.HL.html5.lastevent&&"rshlcontinue"==a.data?(rs.HL.chunking.continueHref=rspkr.HL.html5.lastevent.data,rs.HL.chunking.continueTime=rspkr.HL.html5.lastlastevent&&!isNaN(rspkr.HL.html5.lastlastevent.data)?rspkr.HL.html5.lastlastevent.data:-1,/ios|android|windows phone/i.test(rspkr.c.data.browser.OS)&&
(rspkr.HL.chunking.continueTime=-1)):"rshlresume"==a.data&&(rspkr.HL.html5.synclist.length=0,rspkr.HL.html5.synclistindex=0,rspkr.HL.html5.currentsynclistindex=0,rspkr.HL.html5.currentsyncindex=0)}rspkr.HL.html5.lastlastlastevent=rspkr.HL.html5.lastlastevent;rspkr.HL.html5.lastlastevent=rspkr.HL.html5.lastevent;rspkr.HL.html5.lastevent=a},refresh:function(){var a=rspkr.PlayerAPI.playerRef,b=rspkr.HL.html5;if(!a||b.States.CURRENT==b.States.STOPPED)rspkr.log("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped",
2),b.runningRefresh=!1;else if(b.States.CURRENT==b.States.NOT_PLAYING&&setTimeout(function(){b.refresh()},500),0<a.currentTime&&parseInt(b.lastcurrenttime)>parseInt(Math.ceil(a.currentTime)))rspkr.log("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped.",2),rspkr.ui.getActivePlayer().stop(),b.runningRefresh=!1;else if(b.lastcurrenttime=a.currentTime,b.runningRefresh=!0,b.States.CURRENT==b.States.BEGIN)rspkr.hl.html5.States.setState(b.States.USER_START_NOT_READY),setTimeout(function(){b.refresh()},
200);else if(b.States.CURRENT==b.States.USER_START_NOT_READY)0<b.handlers.totalTime()&&(rspkr.HL.html5.rshlendCall||b.synclist[b.currentsyncindex]&&b.synclist[b.currentsyncindex][0]<1E3*b.handlers.totalTime())?(rspkr.hl.html5.States.setState(b.States.USER_START_PLAYING),rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},50)):0===b.handlers.totalTime()?(rspkr.pl.playPromise(a),setTimeout(function(){b.refresh()},250)):b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*
a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75);else if(b.States.CURRENT==b.States.USER_START_PLAYING){if(b.currentsyncindex===b.synclist.length-1&&0<b.synclist[b.currentsyncindex].length&&"rshlend"===b.synclist[b.currentsyncindex][1]){var c=b.synclist[b.currentsyncindex][0]-
1E3*a.currentTime;0>c&&(c=0);window.setTimeout(rspkr.hl.html5.Events.onEnded,c);b.currentsyncindex++}b.synclist[b.currentsyncindex]&&1*b.synclist[b.currentsyncindex][0]-20<1E3*a.currentTime&&(rspkr.HL.sync.execute(b.synclist[b.currentsyncindex][1],b.synclist[b.currentsyncindex][2]),b.currentsyncindex++);b.synclist[b.currentsyncindex]?20>=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime?setTimeout(function(){b.refresh()},0):(a=1*b.synclist[b.currentsyncindex][0]-1E3*a.currentTime-20,75<a?setTimeout(function(){b.refresh()},
75):0>a?setTimeout(function(){b.refresh()},0):setTimeout(function(){b.refresh()},a)):setTimeout(function(){b.refresh()},75)}}},Preserve:{cls:".rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(a,b,c,j,f){this.name=a;this.type=b;this.value=c;this.checked=j;this.selectedIndex=f;this.selectedOptions=[]},moveToShelter:function(a){rspkr.HL.Preserve.cls=rspkr.cfg.item("general.preserveElements")?rspkr.cfg.item("general.preserveElements"):rspkr.HL.Preserve.cls;rspkr.log("[rspkr.HL.Preserve.moveToShelter]");
var b=[],c=[],j=null,f=[];if(a.childNodes){for(var g=$rs.findIn(a,rspkr.HL.Preserve.cls),g=$rs.isArray(g)?g:[g],j=0;j<g.length;j++)for(var h=j+1;h<g.length;h++)$rs.isArray($rs.findIn(g[j],g[h]))?$rs.isArray($rs.findIn(g[h],g[j]))||(g.splice(j,1),j--,h=g.length):(g.splice(h,1),h--);for(j=0;j<g.length;j++)f.push(g[j])}g=0;for(h=f.length;g<h;g++)j=$rs.get(f[g]).cloneNode(!1),f[g].parentNode.insertBefore(j,f[g]),b.push($rs.detach(f[g]));rspkr.log("[rspkr.hl.Preserve] Moved "+g+" nodes to the shelter.");
a=$rs.findIn(a,"input, select");for(g=0;g<a.length;g++){f=new rspkr.HL.Preserve.formData(a[g].name,a[g].type,a[g].value,a[g].checked,a[g].selectedIndex);if("select-multiple"==a[g].type){for(var j=a[g].options,h=[],l=0;l<j.length;l++)h.push(j[l].selected);f.selectedOptions=h}c.push(f)}rspkr.HL.Preserve.elementShelter.push(b);rspkr.HL.Preserve.formShelter.push(c)},restoreFromShelter:function(a){var b=[],c,j;rspkr.log("[rspkr.HL.Preserve.restoreFromShelter]");if(rspkr.HL.Preserve.elementShelter.length&&
(j=rspkr.HL.Preserve.elementShelter.shift(),j.length)){if(a.childNodes){var f=$rs.findIn(a,rspkr.HL.Preserve.cls),f=$rs.isArray(f)?f:[f];for(c=0;c<f.length;c++)for(var g=c+1;g<f.length;g++)$rs.isArray($rs.findIn(f[c],f[g]))?$rs.isArray($rs.findIn(f[g],f[c]))||(f.splice(c,1),c--,g=f.length):(f.splice(g,1),g--);for(c=0;c<f.length;c++)b.push(f[c])}f=0;for(g=b.length;f<g;f++)c=j.shift(),b[f].parentNode.insertBefore(c,b[f]),b[f].parentNode.removeChild(b[f])}if(rspkr.HL.Preserve.formShelter.length&&(a=
$rs.findIn(a,"input, select"),b=rspkr.HL.Preserve.formShelter.shift(),a.length&&b.length&&a.length===b.length))for(f=0;f<a.length;f++)if(a[f].name===b[f].name)switch(a[f].type){case "text":a[f].value=b[f].value;break;case "password":a[f].value=b[f].value;break;case "radio":!0===b[f].checked&&(a[f].checked=!0);break;case "checkbox":a[f].checked=b[f].checked;break;case "select-one":a[f].selectedIndex=b[f].selectedIndex;break;case "select-multiple":j=a[f].options;for(c=0;c<j.length;c++)j[c].selected=
b[f].selectedOptions[c]}},clearShelter:function(){rspkr.log("[rspkr.HL.Preserve.clearShelter]");rspkr.HL.Preserve.elementShelter=[];rspkr.HL.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.HL.Restore.all]");var a=rspkr.HL.Restore.Storage,b=[],c=null;if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);if(!a.readId.length&&!a.restoreContent.length&&!a.readClass.length)rspkr.log("No stored content exists!",
2);else{var c=$rs.flatten(a.readClass),j=$rs.flatten(a.readId);c&&(c=1<c.length||0===c.length?c:c[0].split(","));j&&(j=1<j.length||0===j.length?j:j[0].split(","));c=c.length?("."+c.join(",.")).split(","):[];c=j.length?c.concat(("#"+j.join(",#")).split(",")):c;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var j=0,f=c.length;j<f;j++)b.push($rs.get(c[j]));else b=$rs.get(c.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);for(j=0;c=b[j];j++)!0===/sync_(word|sent)/gi.test(c.innerHTML)&&
(rspkr.HL.Preserve.moveToShelter(c),c.innerHTML=a.restoreContent[j],rspkr.HL.Preserve.restoreFromShelter(c))}rspkr.c.dispatchEvent("onAfterContentChange",window)}a.readId.length=0;a.readClass.length=0},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",1);!1===this.hasMarkup()&&(rspkr.hl.State.CURRENT==rspkr.hl.State.STOPPED&&rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP)&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},
hasMarkup:function(){var a=rspkr.HL.Restore.Storage,b=[],c=null,c=$rs.flatten(a.readClass),j=$rs.flatten(a.readId);c&&(c=1<c.length||0===c.length?c:c[0].split(","));j&&(j=1<j.length||0===j.length?j:j[0].split(","));c=c.length?("."+c.join(",.")).split(","):[];c=j.length?c.concat(("#"+j.join(",#")).split(",")):c;if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(j=0;j<c.length;j++){var f=$rs.get(c[j]);$rs.isArray(f)&&0<f.length?b.concat(f):$rs.isArray(f)||b.push(f)}else b=
$rs.get(c.join(","));$rs.isArray(b)||(b=[b]);if(b.length&&a.restoreContent.length)for(j=0;c=b[j];j++)if(/sync_(word|sent)/gi.test(c.innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.HL.Restore.setRestoreContent] Called!");if("Explorer"===rs.c.data.browser.name&&9>=rs.c.data.browser.version)for(var a=document.body.getElementsByTagName("style"),b=0,c;c=a[b];b++){c.parentNode.removeChild(c);
document.getElementsByTagName("head")[0].appendChild(c);var j=c.innerHTML;if(-1!=j.indexOf("@import")){for(var f=j.split("\n"),g,h=0;j=f[h];h++)if("@import"===j.substring(0,7)){h=j.replace(/;/g,"").replace("@import ","").replace("url(","").replace(")","").replace(/\"/g,"").replace(/\'/g,"").split(" ");for(f=0;f<h.length;f++){var l=h[f].replace(/ /g,"");if(l){g=l;break}}break}c=c.sheet?c.sheet:c.styleSheet;c.insertRule?c.insertRule(j,0):c.addImport&&c.addImport(g)}}a=rspkr.HL.Restore.Storage;b=[];
g=a.restoreContent;0===a.readClass.length&&0===a.readId.length&&rspkr.HL.Restore.getReadData();if(0==a.readClass.length&&0==a.readId.length)rspkr.log("ERR: Could not set restore content or find the read area data",3);else{c=$rs.flatten(a.readClass);j=$rs.flatten(a.readId);c&&(c=1<c.length||0===c.length?c:c[0].split(","));j&&(j=1<j.length||0===j.length?j:j[0].split(","));c=c.length?("."+c.join(",.")).split(","):[];c=j.length?c.concat(("#"+j.join(",#")).split(",")):c;if(rspkr.cfg.item("general.readidOrder")&&
rspkr.cfg.item("general.usePost")){j=0;for(h=c.length;j<h;j++)b.push($rs.get(c[j]))}else b=$rs.get(c.join(","));b=$rs.flatten(b);$rs.isArray(b)||(b=[b]);a.restoreContent=[];for(h=0;c=b[h];h++)!1===/sync_(word|sent|user)/gi.test(c.innerHTML)?a.restoreContent.push(c.innerHTML):0<g.length&&g[h]?a.restoreContent.push(g[h]):a.restoreContent.push(c.innerHTML)}},getReadData:function(){rspkr.log("[rspkr.HL.Restore.getReadData]");var a=rspkr.HL.Restore.Storage,b;b=rspkr.ui.getActivePlayer()?$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),
".rsbtn_play"):$rs.findIn($rs.get("."+rs.ui.rsbtnClass),".rsbtn_play");$rs.isArray(b)||(b=[b]);for(var c=0,h=b.length;c<h;c++){var f=b[c].getAttribute("href").match(/readspeaker.?.com\/cgi-bin\/.*rsent/gi);rspkr.cfg.item("general.servercall")&&(f=f?f:-1<b[c].getAttribute("href").indexOf(rspkr.cfg.item("general.servercall")));if(b[c].getAttribute("href")&&-1!==(b[c].getAttribute("href").indexOf(rspkr.cfg.item("general.domain")+"/cgi-bin/"+rspkr.cfg.item("general.rsent"))||f)&&"rsSaveBtn"!==b[c].id&&
"rs_selimg"!==b[c].id)-1!==b[c].getAttribute("href").search(/readclass=/)&&(f=b[c].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=",""),f=f.split(","),rspkr.HL.Restore.Storage.readClass.push(f)),-1!==b[c].getAttribute("href").search(/readid=/)&&(f=b[c].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=",""),f=f.split(","),rspkr.HL.Restore.Storage.readId.push(f))}0===a.readClass.length&&0===a.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&
a.readId.push([rspkr.c.data.params.readid]),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&a.readClass.push([rspkr.c.data.params.readclass]))}},Scroll:{currentSpan:null,timer:null,useScroll:!1,userScrollTimer:null,stopped:!0,getScrollY:function(){var a=0;"number"==typeof document.pageYOffset?a=document.pageYOffset:document.documentElement&&document.documentElement.scrollTop&&0<document.documentElement.scrollTop?a=document.documentElement.scrollTop:document.body&&
document.body.scrollTop&&(a=document.body.scrollTop);return a},getWindowHeight:function(){var a=0;"number"==typeof window.innerHeight?a=window.innerHeight:document.documentElement&&document.documentElement.clientHeight&&0<document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&document.body.clientHeight&&(a=document.body.clientHeight);return a+30},userScroll:function(){rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.userScrollTimer&&
clearTimeout(rspkr.HL.Scroll.userScrollTimer);rspkr.HL.Scroll.userScrollTimer=setTimeout(function(){rspkr.HL.Scroll.userScrollTimer=null},5E3)},stopTimer:function(){rspkr.log("[rspkr.Hl.Scroll.stopTimer] Called!");rspkr.HL.Scroll.timer&&(clearTimeout(rspkr.HL.Scroll.timer),rspkr.HL.Scroll.timer=null);rspkr.HL.Scroll.stopped=!0},initScroll:function(){"scrollon"==rspkr.Common.Settings.get("hlscroll")?(rspkr.log("[rspkr.HL.Sroll.initScroll] Scroll initiated!"),rspkr.HL.Scroll.useScroll=!0,rspkr.evt("onUIClosePlayer",
rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIStop",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUIPause",rspkr.HL.Scroll.stopTimer),rspkr.evt("onUISliderMove",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusIn",rspkr.HL.Scroll.userScroll),rspkr.evt("onFocusOut",rspkr.HL.Scroll.userScroll),document.addEventListener?document.addEventListener("scroll",function(){setTimeout(function(){rspkr.HL.Scroll.userScroll()},0)},!1):document.attachEvent?document.attachEvent("onscroll",rspkr.HL.Scroll.userScroll):document.onscroll=
rspkr.HL.Scroll.userScroll):this.useScroll=!1},execScroll:function(a){this.useScroll&&(this.currentSpan=a,!0===this.stopped&&(this.stopped=!1),this.timer||(rspkr.log("[rspkr.hl.Scroll] execScroll"),this.timer=setTimeout(function(){rspkr.HL.Scroll.timer=null;rspkr.HL.Scroll.triggerScroll(rspkr.HL.Scroll.currentSpan)},500)))},triggerScroll:function(a){rspkr.log("[rspkr.HL.Scroll.triggerScroll] timer: "+rspkr.hl.Scroll.userScrollTimer+", stopped: "+rspkr.HL.Scroll.stopped);!rspkr.HL.Scroll.userScrollTimer&&
!1===rspkr.HL.Scroll.stopped&&rspkr.u.scroll.scrollToElm(a)}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(a){this.CURRENT=a;rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+a,1)}},sync:{init:function(){rspkr.c.dispatchEvent("onBeforeSyncInit",window);h.hlChanged=!1;if(0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.HL._sync.init] client markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.CLIENT_MARKUP,
b.firstRun=1,"explorer"==a?document.selection.empty():b.preProcess.identifyElementsReplacementNode(document.body);else if(rspkr.log("[rspkr.HL._sync.init] server markup"),rspkr.HL.Type.CURRENT=rspkr.HL.Type.SERVER_MARKUP,"none"!=rspkr.Common.data.sync){var c=[],k=[],p=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&(p=p.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(",")));rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&
(p=p.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));if(rspkr.cfg.item("general.readidOrder")&&rspkr.cfg.item("general.usePost"))for(var j=0;j<p.length;j++){var f=$rs.get(p[j]);$rs.isArray(f)&&0<f.length?c.concat(f):$rs.isArray(f)||c.push(f)}else c=$rs.get(p.join(","));$rs.isArray(c)||(c=[c]);if("flash"==rspkr.PlayerAPI.adapter&&rspkr.HL.markedUpHTML.length!==c.length){p=rspkr.HL.markedUpHTML.join("").split("<\!--RSPEAK_STOP--\>");for(j=0;p[j];j++);}else p=rspkr.HL.markedUpHTML;
for(j=0;f=c[j];j++)f=f.nodeName&&"TABLE"==f.nodeName?document.createElement("TABLE"):document.createElement("DIV"),f.innerHTML=p[j],k.push(f);rspkr.log("[rspkr.HL.sync.init] readElements length: "+c.length);if(!rspkr.cfg.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);for(j=0;j<c.length;j++)rspkr.HL.Preserve.moveToShelter(c[j]),c[j].innerHTML=k[j].innerHTML,rspkr.HL.Preserve.restoreFromShelter(c[j]);rspkr.c.dispatchEvent("onAfterContentChange",window);rspkr.HL.Preserve.clearShelter()}}rspkr.HL.markedUpHTML.length=
0;rspkr.c.post.removeIframe();rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.log("[rspkr.HL._sync.lightCleanUp] Called! "+rspkr.HL.Type.CURRENT);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!0===h.hlChanged?b.postProcess.settingsCleanUp():rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&!1===h.hlChanged||0<rspkr.Common.data.selectedText.length?b.postProcess.lightCleanUp():rspkr.HL.Type.CURRENT==
rspkr.HL.Type.SERVER_MARKUP&&c.postProcess.lightCleanUp();rspkr.HL.html5.frameUrl=""},fullCleanUp:function(){rspkr.log("[rspkr.HL._sync.fullCleanUp] Called!");rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.cleanUp();rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP&&b.postProcess.fullCleanUp();c.postProcess.fullCleanUp()},setId:function(){rspkr.log("[rspkr.HL._sync.setId] Called!")},setClass:function(){rspkr.log("[rspkr.HL._sync.setClass] Called!")},setContent:function(a){rspkr.log("[rspkr.HL._sync.setContent] Called!");
rspkr.HL.markedUpHTML.push(a)},execute:function(a,b){var c=rspkr.Common.Settings;if(!("none"===c.get("hl")||"hloff"===c.get("hltoggle"))){if(rspkr.HL.Type.CURRENT==rspkr.HL.Type.SERVER_MARKUP){var h=$rs.hasClass($rs.get("#sync"+b),"sync_sent")?"sent":"word";if("sent"===c.get("hl")&&"word"===h||"word"===c.get("hl")&&"sent"===h)return}rspkr.c.dispatchEvent("onBeforeSync",window,[a,b]);rspkr.HL.Type.CURRENT==rspkr.HL.Type.CLIENT_MARKUP?(c=rspkr.cfg.item("general.selectionEngine"))&&("new"===c||"newcontent"===
c)?rspkr.HL.clientMarkup.syncNew(a,b):rspkr.HL.clientMarkup.sync(a,b):rspkr.HL.serverMarkup.sync(a,b);rspkr.c.dispatchEvent("onAfterSync",window,[a,b])}}},settings:h,Type:{CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2}}}();rspkr.HL.engine||(rspkr.HL.engine={});
rspkr.HL.engine.explorer=function(){return{clientExtension:{firstRun:0,previousWord:{},previousSent:{},selectionRange:null,selectionHTML:null,selectedWordsRange:[],wordsRangeClasses:[],originalParentContent:"",originalParent:null,preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;
var a;a="new"===rspkr.cfg.item("general.selectionEngine")||"newcontent"===rspkr.cfg.item("general.selectionEngine")?this.buildMarkupNew(rspkr.Common.data.selectedRange):this.buildMarkup(rspkr.Common.data.selectedRange);a.replace(/  +/g," ");rspkr.Common.data.selectedHTML=a;rspkr.hl.clientMarkup.originalParent=rspkr.c.data.selectedRange.parentElement();rspkr.hl.clientMarkup.originalParentContent=rspkr.c.data.selectedRange.parentElement().innerHTML},buildMarkup:function(a){for(var b=rspkr.c.data.getParam("lang"),
c=!1,h=null,e=rspkr.cfg.item("general.sentOnlyLang"),k=0;k<e.length;k++)if(b&&b.toLowerCase()===e[k]){c=!0;break}var b=a.duplicate(),k=0,e="",p=1,j=0,f=0,g="",m="",l=null;a.moveStart("word",-1);a.moveStart("word",1);b.isEqual(a)||a.moveStart("word",-1);b=a.duplicate();a.moveEnd("word",1);a.moveEnd("word",-1);b.isEqual(a)||a.moveEnd("word",1);rspkr.HL.clientMarkup.selectionRange=a.duplicate();var n=a.parentElement(),v=a.duplicate();v.collapse(!1);b=a.duplicate();b.collapse();for(c&&(h=a.text.split(RegExp(decodeURIComponent("%e3%80%81")+
"|"+decodeURIComponent("%e3%80%82")+"|"+decodeURIComponent("%DB%94")+"|"+decodeURIComponent("%D8%8C"))));a.inRange(b)&&0!=a.compareEndPoints("EndToEnd",b);){f++;k++;if(1E4<k)break;if(c)if(b=a.duplicate(),h[f-1])b.findText(h[f-1]);else break;else b.collapse(!1),b.expand("word",1);m=g="";v.collapse(!1);var q=b.duplicate();q.collapse(!1);if(0==v.compareEndPoints("StartToStart",q)&&0==v.compareEndPoints("EndToEnd",q)&&q.htmlText==v.htmlText&&/\W/.test(q.text)){j++;if(2>j)b.move("character",1);else if(4>
j)b.move("character",2);else if(6>j)b.move("word",1);else if(8>j)b.move("word",2);else if(10>j)b.move("sentence",1);else if(12>j)b.move("sentence",2);else break;b.collapse(!1)}else{j=0;if(-1===f)return b;rspkr.HL.clientMarkup.selectedWordsRange[f]=b.duplicate();v=b.text;q=b.htmlText;b.collapse(!1);var t;1===p?(l=b.duplicate(),t=this.iterateParentTree(l.parentElement(),document.body,n,0)):t=this.iterateParentTree(b.parentElement(),l.parentElement(),n,0);for(var w=this.iterateParentTree(l.parentElement(),
b.parentElement(),n,0),r=b.parentElement(),u=0;u<t&&20>u;u++)r.className.match("sync_")||(g=r.outerHTML.match("<[^>]*>")[0]+g),r=r.parentElement;r=l.parentElement();for(u=0;u<w&&20>u;u++)r.className.match("sync_")||(m+="</"+r.tagName+">"),r=r.parentElement;if(0!=t||0!=w)l=b.duplicate();1===p?(e+=g,p=0):e+=m+g;""!=q.replace("sync_sent_highlighted","")&&(g=f,m=$rs.get("#sync"+f),$rs.isArray(m)&&0<m.length&&(g=Math.floor(1E3*Math.random()+1E3)),e+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user" id="sync'+
g+'">'+v+"</"+rspkr.Common.data.browser.syncContainer+">");v=b.duplicate()}}e+="<\!-- f --\>";w=this.iterateParentTree(l.parentElement(),document.body,n,0);r=l.parentElement();for(u=0;u<w;u++)r.className.match("sync_")||(e+="</"+r.tagName+">"),r=r.parentElement;b.collapse();return e},buildMarkupNew:function(a){for(var b=rspkr.c.data.getParam("lang"),c=!1,h=rspkr.cfg.item("general.sentOnlyLang"),e=0;e<h.length;e++)if(b&&b.toLowerCase()===h[e]){c=!0;break}var b=a.duplicate(),h="",k=1,p=0,j=0,f="",g=
"",m="",l=null,e=0;rspkr.HL.clientMarkup.selectionRange=a.duplicate();var n=a.parentElement(),v=a.duplicate(),m=a.duplicate();v.collapse(!1);b.collapse();var q=[],t=m.duplicate(),f=m.duplicate();m.moveStart("sentence",-1);m.moveStart("sentence",1);t.isEqual(m)||m.moveStart("sentence",-1);t=m.duplicate();m.moveEnd("sentence",1);m.moveEnd("sentence",-1);t.isEqual(m)||m.moveEnd("sentence",1);t=m.duplicate();f.collapse(!0);for(m.collapse(!0);t.inRange(m)&&0!=t.compareEndPoints("EndToEnd",m);){f.expand("sentence",
1);if(!0===f.isEqual(m)||0===f.compareEndPoints("EndToEnd",m))break;m.expand("sentence",1);q.push(f.duplicate())}for(;!1===a.inRange(q[0])&&0!=a.compareEndPoints("StartToStart",q[0]);)q[0].moveStart("word",1);for(;!1===a.inRange(q[q.length-1])&&0!=a.compareEndPoints("EndToEnd",q[q.length-1]);)q[q.length-1].moveEnd("word",-1);for(t=0;t<q.length;t++){for(m="";q[t].inRange(b)&&0!=q[t].compareEndPoints("EndToEnd",b);){j++;e++;if(1E4<e)break;c?(b=a.duplicate(),b.findText(null[j-1])):(b.collapse(!1),b.expand("word",
1));g=f="";v.collapse(!1);var w=b.duplicate();w.collapse(!1);if(0==v.compareEndPoints("StartToStart",w)&&0==v.compareEndPoints("EndToEnd",w)&&w.htmlText==v.htmlText){p++;if(2>p)b.move("character",1);else if(4>p)b.move("character",2);else if(6>p)b.move("word",1);else if(8>p)b.move("word",2);else if(10>p)b.move("sentence",1);else if(12>p)b.move("sentence",2);else break;b.collapse(!1)}else{p=0;if(-1===j)return b;rspkr.HL.clientMarkup.selectedWordsRange[j]=b.duplicate();rspkr.HL.clientMarkup.wordsRangeClasses[j]=
"word";v=b.text;w=b.htmlText;b.collapse(!1);var r;1===k?(l=b.duplicate(),r=this.iterateParentTree(l.parentElement(),document.body,n,0)):r=this.iterateParentTree(b.parentElement(),l.parentElement(),n,0);for(var u=this.iterateParentTree(l.parentElement(),b.parentElement(),n,0),x=b.parentElement(),z=0;z<r&&20>z;z++)x.className.match("sync_")||(f=x.outerHTML.match("<[^>]*>")[0]+f),x=x.parentElement;x=l.parentElement();for(z=0;z<u&&20>z;z++)x.className.match("sync_")||(g+="</"+x.tagName+">"),x=x.parentElement;
if(0!=r||0!=u)l=b.duplicate();1===k?(m+=f,k=0):m+=g+f;""!=w.replace("sync_sent_highlighted","")&&(f=j,g=$rs.get("#sync"+j),$rs.isArray(g)&&0<g.length&&(f=Math.floor(1E3*Math.random()+1E3)),m+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word" id="sync'+f+'">'+v+"</"+rspkr.Common.data.browser.syncContainer+">");v=b.duplicate()}}j++;rspkr.HL.clientMarkup.selectedWordsRange[j]=q[t];rspkr.HL.clientMarkup.wordsRangeClasses[j]="sent";f=j;g=$rs.get("#sync"+j);$rs.isArray(g)&&0<g.length&&
(f=Math.floor(1E3*Math.random()+1E3));h+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent" id="sync'+f+'">';h+=m;h+="</"+rspkr.Common.data.browser.syncContainer+">\n"}u=this.iterateParentTree(l.parentElement(),document.body,n,0);x=l.parentElement();for(z=0;z<u;z++)x.className.match("sync_")||(h+="</"+x.tagName+">"),x=x.parentElement;b.collapse();return h},iterateParentTree:function(a,b,c,h){for(var e=b;null!==e;){if(a==c||a==e)return h;e=e.parentElement}h++;return this.iterateParentTree(a.parentElement,
b,c,h)}},postProcess:{lightCleanUp:function(){rspkr.log("[clientMarkup.postProcess.lightCleanUp] called!");for(var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),b=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),b=$rs.isArray(b)?b:[b],a=b.length-1;-1<a;a--)b[a].className=b[a].className.replace("sync_sent_highlighted","sync_sent"),b[a].className=b[a].className.replace("sync_word_highlighted",
"sync_word"),-1===b[a].className.toLowerCase().indexOf("sync_user")&&(b[a].removeAttribute("id"),b[a].removeAttribute("color"));var b=rspkr.HL.clientMarkup.previousWord.range,c=rspkr.HL.clientMarkup.previousWord.forecolor,h=rspkr.HL.clientMarkup.previousWord.backcolor,e=rspkr.HL.clientMarkup.previousSent.range,k=rspkr.HL.clientMarkup.previousSent.forecolor,p=rspkr.HL.clientMarkup.previousSent.backcolor;if(b&&0<b.length)for(var a=0,j=b.length;a<j;a++)null!==h[a]&&(b[a].execCommand("backcolor",0,h[a]),
null!==c[a]&&b[a]&&b[a].execCommand("forecolor",0,c[a]));if(b&&0<e.length){a=0;for(j=e.length;a<j;a++)null!==p[a]&&(e[a].execCommand("backcolor",0,p[a]),null!==k[a]&&e[a]&&e[a].execCommand("forecolor",0,k[a]))}rspkr.hl.clientMarkup.lastWord=null},settingsCleanUp:function(){this.lightCleanUp()},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");if(null===rspkr.hl.clientMarkup.originalParent)this.lightCleanUp();else{var a=rspkr.hl.clientMarkup.originalParent;rspkr.hl.Preserve.moveToShelter(a);
a.innerHTML=rspkr.hl.clientMarkup.originalParentContent;rspkr.hl.Preserve.restoreFromShelter(a)}rspkr.hl.clientMarkup.selectedWordsRange=[];rspkr.hl.clientMarkup.selectionRange=null;rspkr.hl.clientMarkup.originalParentContent="";rspkr.hl.clientMarkup.originalParent=null;rspkr.hl.clientMarkup.lastWord=null}},sync:function(a,b){var c=!1,h;0===(a&2)&&(c=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=
[],this.previousSent.backcolor=[],this.previousSent.forecolor=[]);h=this.selectedWordsRange[b];if(1===this.firstRun){this.firstRun=0;if(0<this.previousSent.range.length){for(var e=0,k=this.previousSent.range.length;e<k;e++)this.previousSent.range[e].execCommand("backcolor",0,this.previousSent.backcolor[e]),null!==this.previousSent.forecolor[e]&&this.previousSent.range[e].execCommand("forecolor",0,this.previousSent.forecolor[e]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}rspkr.HL.clientMarkup.selectionRange&&"wordsent"===rspkr.st.get("hl")&&(this.previousSent.range.push(rspkr.HL.clientMarkup.selectionRange),this.previousSent.backcolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("backcolor")),this.previousSent.forecolor.push(rspkr.HL.clientMarkup.selectionRange.queryCommandValue("forecolor")),this.selectionRange.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.selectionRange.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext")))}if(!c&&
0<this.previousWord.range.length){for(e=0;e<this.previousWord.range.length;e++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[e].execCommand("backcolor",0,this.previousWord.backcolor[e]):this.previousWord.range[e].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[e].execCommand("forecolor",0,this.previousWord.forecolor[e]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(h.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(h.queryCommandValue("forecolor"));this.previousWord.range.push(h);"sent"==rspkr.st.get("hl")?(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.sentHL(h,a),h.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"))):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(h,a),h.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword")));this.lastWord=h;rspkr.HL.customHL&&rspkr.HL.customHL.active();h.execCommand("forecolor",
0,rspkr.Common.Settings.get("hltext"))},syncNew:function(a,b){var c=!1;0===(a&2)&&(c=0!=(a&1)?!0:!1);1===this.firstRun&&(this.previousWord.range=[],this.previousWord.backcolor=[],this.previousWord.forecolor=[],this.previousSent.range=[],this.previousSent.backcolor=[],this.previousSent.forecolor=[],this.firstRun=0);var h=this.selectedWordsRange[b];if(h&&"word"===this.wordsRangeClasses[b]&&("word"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length&&!c){for(c=0;c<
this.previousWord.range.length;c++)"word"==rspkr.st.get("hl")||"sent"==rspkr.st.get("hl")?this.previousWord.range[c].execCommand("backcolor",0,this.previousWord.backcolor[c]):this.previousWord.range[c].execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent")),this.previousWord.range[c].execCommand("forecolor",0,this.previousWord.forecolor[c]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}this.previousWord.backcolor.push(h.queryCommandValue("backcolor"));
this.previousWord.forecolor.push(h.queryCommandValue("forecolor"));this.previousWord.range.push(h);h.execCommand("backcolor",0,rspkr.Common.Settings.get("hlword"));this.lastWord=h;h.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}else if(h&&"sent"===this.wordsRangeClasses[b]&&("sent"==rspkr.st.get("hl")||"wordsent"==rspkr.st.get("hl"))){if(0<this.previousWord.range.length){for(c=0;c<this.previousWord.range.length;c++)this.previousWord.range[c].execCommand("backcolor",0,this.previousWord.backcolor[c]),
this.previousWord.range[c].execCommand("forecolor",0,this.previousWord.forecolor[c]);this.previousWord.range=[];this.previousWord.backcolor=[];this.previousWord.forecolor=[]}if(0<this.previousSent.range.length){for(c=0;c<this.previousSent.range.length;c++)this.previousSent.range[c].execCommand("backcolor",0,this.previousSent.backcolor[c]),this.previousSent.range[c].execCommand("forecolor",0,this.previousSent.forecolor[c]);this.previousSent.range=[];this.previousSent.backcolor=[];this.previousSent.forecolor=
[]}this.previousSent.backcolor.push(h.queryCommandValue("backcolor"));this.previousSent.forecolor.push(h.queryCommandValue("forecolor"));this.previousSent.range.push(h);h.execCommand("backcolor",0,rspkr.Common.Settings.get("hlsent"));h.execCommand("forecolor",0,rspkr.Common.Settings.get("hltext"))}}}}}();
rspkr.HL.engine.gecko=function(){return{clientExtension:{preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:"table tr select option textarea ul ol dl thead tbody tfoot colgroup script map optgroup style noscript".split(" "),firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,init:function(){this.numberOfSelections++;var a="",a=rspkr.Common.data.selectedRange;this.startNode=a.startContainer;this.endNode=a.endContainer;this.startOffset=this.modifyOffsetStartOfWord(this.startNode,
a.startOffset);this.endOffset=this.modifyOffsetEndOfWord(this.endNode,a.endOffset);a=this.buildMarkup(a.commonAncestorContainer);a.replace(/  +/g," ");window.getSelection().removeAllRanges();rspkr.Common.data.selectedHTML=a},buildMarkup:function(a){this.firstRun=1;var b="",c=this.inc;if(3==a.nodeType)b+=this.textMarkup(a);else{var h,e="";if(a.hasChildNodes())for(h=0;h<a.childNodes.length;h++){var k=a.childNodes.item(h);k==this.startNode&&(this.inc=1);a==this.startNode&&h==this.startOffset&&(this.inc=
1);8!=k.nodeType&&(e+=this.buildMarkup(k));if(a==this.endNode&&h==this.endOffset){this.inc=0;break}if(k==this.endNode){this.inc=0;break}}h=!0;null!=$rs.getAttr(a,"id")&&(h=$rs.getAttr(a,"id").replace("sync")===$rs.getAttr(a,"id"));(c||this.inc)&&(!a.className||"string"===typeof a.className&&a.className.replace("sync")===a.className&&h)?(c=document.createElement("div"),c.appendChild(a.cloneNode(!0)),tempdivtag=c.innerHTML.match("<[^>]*>"),null!==tempdivtag&&0<tempdivtag.length?(b+=tempdivtag[0],b=
b+e+("</"+a.nodeName+">")):b+=e):b+=e;if(a.hasChildNodes())for(h=0;h<a.childNodes.length;h++){if(a===this.endNode&&h===this.endOffset){this.inc=0;break}if(k===this.endNode){this.inc=0;break}}}return b},textMarkup:function(a){var b=!0,c="",h,e="",k="",p=a.nodeValue;a===this.startNode&&-1!==this.startOffset&&a===this.endNode&&-1!==this.endOffset?(e=a.nodeValue.substring(0,this.startOffset),p=a.nodeValue.substring(this.startOffset,this.endOffset),k=a.nodeValue.substring(this.endOffset),this.inc=1):a===
this.startNode&&-1!==this.startOffset?(e=a.nodeValue.substring(0,this.startOffset),p=a.nodeValue.substring(this.startOffset),this.inc=1):a===this.endNode&&-1!==this.endOffset&&(p=a.nodeValue.substring(0,this.endOffset),k=a.nodeValue.substring(this.endOffset),this.inc=1);if(!this.inc)return"";for(h=0;h<this.excludednodes.length;h++)if(a.parentNode&&a.parentNode.nodeName.toLowerCase()===this.excludednodes[h]){b=!1;c=this.htmlencode(p);break}b&&(c=(c=rspkr.cfg.item("general.selectionEngine"))&&("new"===
c||"newcontent"===c)?this.markupSentencesNew(this.htmlencode(p),null):this.markupSentences(this.htmlencode(p),null));a===this.endNode&&-1!==this.endOffset&&(this.inc=0);if(rs.cfg.item("general.enableSkipAlways")){h=a;for(var j=!1;h.parentNode;){if(/rs_skip_always/i.test(h.className)){j=!0;break}h=h.parentNode}j&&(c='<span class="rs_skip_always">'+c+"</span>")}b&&(null!==a.parentNode&&""!==p)&&(b=this.createreplacementnode(e+c+k,getComputedStyle(a.parentNode,null)),a.parentNode.insertBefore(b,a),a.parentNode.removeChild(a));
return c},markupSentencesNew:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",c="",h=!1,e=0;e<a.length;e++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent cj'+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[e])?(h=!0,c=a[e].slice(0,-1)):c=a[e],b+=this.markupWords(c),b+="</"+
rspkr.Common.data.browser.syncContainer+">",!0===h&&(b+=" "),h=!1;return b},markupSentences:function(a){a=this.splitString(a,[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")]);if(!a)return"";for(var b="",c="",h=!1,e=0;e<a.length;e++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',b+='id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[e])?
(h=!0,c=a[e].slice(0,-1)):c=a[e],b+=this.markupWords(c),!0===h&&(b+=" "),b+="</"+rspkr.Common.data.browser.syncContainer+">",h=!1;return b},markupWords:function(a){a=this.splitString(a," ");if(!a)return"";for(var b="",c="",h=!1,e=0;e<a.length;e++)b+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',b+=' id="sync'+this.bookMarkIndex++ +'">',this.endsWithSpace(a[e])?(h=!0,c=a[e].slice(0,-1)):c=a[e],b+=c,b+="</"+rspkr.Common.data.browser.syncContainer+
">",!0===h&&(b+=" "),h=!1;return b},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},htmlencode:function(a){var b=document.createElement("div"),a=document.createTextNode(a);b.appendChild(a);return b.innerHTML},identifyElementsReplacementNode:function(a){a.tagName&&(a.tagName.toLowerCase()==rspkr.Common.data.browser.syncContainer&&a.id)&&(rspkr.HL.clientMarkup.selectedWordsRange[a.id]=a);if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.identifyElementsReplacementNode(a.childNodes[b])},
createreplacementnode:function(a){var b=document.createElement(rspkr.Common.data.browser.syncContainer);b.innerHTML=a;b.setAttribute("class","synctemp cl"+this.numberOfSelections);return b},modifyOffsetStartOfWord:function(a,b){for(var c=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&0!=b;){for(var h=0;h<c.length;h++)if(breakstr=c[h],0==a.nodeValue.substring(b).indexOf(breakstr))return b;
b--}return b},modifyOffsetEndOfWord:function(a,b){for(var c=[" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")];a.nodeValue&&b!=a.nodeValue.length;){for(var h=0;h<c.length;h++)if(breakstr=c[h],0==a.nodeValue.substring(b-1).indexOf(breakstr))return b;b++}return b},returnClassArraySubstring:function(a){a=$rs.get("."+a);return a=$rs.isArray(a)?a:[a]},splitString:function(a,b){for(var c=[""],h=0,e=0;e<a.length;e++){for(var k=
0;k<b.length;k++){for(var p=b[k],j=!0,f=0;f<p.length;f++)if(0>a.length-(e+f)||p[p.length-f-1]!=a[e-f-1]){j=!1;break}j&&(h++,c[h]="")}c[h]+=a[e]}return c},endsWithSpace:function(a){return-1!==a.indexOf(" ",a.length-1)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+
a+".synctemp,"+a+'[class*="ffsent"]'),b,a=$rs.isArray(a)?a:[a];for(i=a.length-1;-1<i;i--)b=document.createDocumentFragment(),b.textContent=a[i].textContent,a[i].parentNode.replaceChild(b,a[i])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var a=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1"),a=$rs.get(a+".sync_sent,"+a+".sync_word,"+a+".sync_sent_highlighted,"+a+".sync_word_highlighted,"+a+".sync_user,"+a+".synctemp,"+a+'[class*="ffsent"]'),
a=$rs.isArray(a)?a:[a];for(i=a.length-1;-1<i;i--)rspkr.HL.chunking.continueHref||(a[i].className=a[i].className.replace("sync_sent_highlighted","sync_sent")),a[i].className=a[i].className.replace("sync_word_highlighted","sync_word"),!rspkr.HL.chunking.continueHref&&-1===a[i].className.toLowerCase().indexOf("sync_user")&&a[i].removeAttribute("id")},settingsCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.settingsCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,b=rspkr.HL.clientMarkup.previousWord.className,
c=rspkr.HL.clientMarkup.previousSent.element,h=rspkr.HL.clientMarkup.previousSent.className;if(0<a.length){for(var e in a)a[e].className=b[e];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<c.length){for(e in c)c[e].className=h[e];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=[]}},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!");var a=rspkr.HL.clientMarkup.previousWord.element,
b=rspkr.HL.clientMarkup.previousWord.className,c=rspkr.HL.clientMarkup.previousSent.element,h=rspkr.HL.clientMarkup.previousSent.className;if(!("undefined"===typeof a||"undefined"===typeof b||"undefined"===typeof c||"undefined"===typeof h)){if(0<a.length){for(var e in a)a[e].className=b[e];rspkr.HL.clientMarkup.previousWord.element=[];rspkr.HL.clientMarkup.previousWord.className=[]}if(0<c.length){for(e in c)c[e].className=h[e];rspkr.HL.clientMarkup.previousSent.element=[];rspkr.HL.clientMarkup.previousSent.className=
[]}this.cleanUpSpans();rspkr.Common.data.selectedHTML=""}}},sync:function(a,b){var c=!1,h;0==(a&2)&&(c=0!=(a&1)?!0:!1);1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[]);if(h=this.selectedWordsRange["sync"+b]){if(h.className.replace("word","")!=h.className){rspkr.log("inside");if(0<this.previousWord.element.length&&0<this.previousWord.className.length&&!c){for(c=0;c<this.previousWord.element.length;c++)this.previousWord.element[c].className=
this.previousWord.className[c];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(h);this.previousWord.className.push(h.className);"sent"===rspkr.st.get("hl")?h.className=h.className.replace("sync_sent","sync_user sync_sent_highlighted"):(rspkr.HL.customHL&&rspkr.HL.customHL.active()&&rspkr.HL.customHL.wordHL(h,a),h.className=h.className.replace("sync_word","sync_user sync_word_highlighted"))}h&&rspkr.HL.Scroll.execScroll(h);if(1==this.firstRun){this.firstRun=
0;if(0<this.previousSent.element.length){for(c=0;c<this.previousSent.element.length;c++)this.previousSent.element[c].className=this.previousSent.className[c];this.previousSent.element=[];this.previousSent.className=[]}if("wordsent"==rspkr.st.get("hl")){h=this.preProcess.returnClassArraySubstring("ffsent"+this.preProcess.numberOfSelections+" ");for(c=0;c<h.length;c++)this.previousSent.element[c]=h[c],this.previousSent.className[c]=h[c].className,h[c].className="ffsent"+this.preProcess.numberOfSelections+
" sync_sent_highlighted"}}}},syncNew:function(a,b){var c;1==this.firstRun&&(this.previousWord.element=[],this.previousWord.className=[],this.previousSent.element=[],this.previousSent.className=[],this.firstRun=0);c=document.getElementById("sync"+b);if(c.className.replace("word","")!=c.className&&("word"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousWord.element.length&&0<this.previousWord.className.length){for(var h=0;h<this.previousWord.element.length;h++)this.previousWord.element[h].className=
this.previousWord.className[h];this.previousWord.element=[];this.previousWord.className=[]}this.previousWord.element.push(c);this.previousWord.className.push(c.className);c.className="sync_user sync_word_highlighted"}else if(c.className.replace("sent","")!=c.className&&("sent"===rspkr.st.get("hl")||"wordsent"===rspkr.st.get("hl"))){if(0<this.previousSent.element.length&&0<this.previousSent.className.length){for(h=0;h<this.previousSent.element.length;h++)this.previousSent.element[h].className=this.previousSent.className[h];
this.previousSent.element=[];this.previousSent.className=[]}this.previousSent.element.push(c);this.previousSent.className.push(c.className);c.className=c.className.replace("sync_sent","sync_user sync_sent_highlighted")}c&&rspkr.HL.Scroll.execScroll(c)}}}}();
ReadSpeaker.ui=function(){var a=null,b=[],c=[],h=!1,e=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},k=function(){rspkr.log("[rspkr.ui] Attempting to add click events.");var a=$rs.get("."+rspkr.ui.rsbtnClass+" .rsbtn_play"),b=null;$rs.isArray(a)||(a=[a]);for(var c=0,f=a.length;c<f;c++)if($rs.unregEvent(a[c],"click",ReadSpeakerDefer.clickhandler),b=a[c]?$rs.getAttr(a[c],
"data-rsevent-id"):"_bogus_",rspkr.l.f.eq.store[b]&&rspkr.l.f.eq.store[b].click)rspkr.log("[rspkr.ui] Click event already existed on "+a[c],2);else{$rs.regEvent(a[c],"click",function(a){e(a);window.readpage(this)});rspkr.ui.addFocusHandler(a[c],!0,a[c].parentNode);rspkr.log("[rspkr.ui] Added click event to: "+a[c],1);try{$rs.getAttr(a[c],"role")||$rs.setAttr(a[c],"role","button")}catch(g){rspkr.log("[rspkr.ui] Could not add role attribute.",2)}}},p=function(){rspkr.log("[rspkr.ui] Initiating global callbacks");
rspkr.ui.rsbtnClass=rspkr.cfg.item("ui.rsbtnClass")||"rsbtn";window.readpage=function(a,b){if(rspkr.ui.initrun){if(/safari|ios|ipad|iphone|ipod|android|windows phone/i.test(window.navigator.userAgent)){var c=window.rspkr;c.audio=new Audio;/safari/i.test(window.navigator.userAgent)&&(c.audio.muted=!0);rspkr.pl.playPromise(c.audio,void 0,void 0,!0)}rspkr.ui.showPlayer(a,b)}};window.rshlexit=function(b){rspkr.HL.chunking.destroy();(void 0===b||"false"===b)&&a.stop();setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",
window)},1E3)};window.rshlinit=w().sync.init;window.rshlsetContent=w().sync.setContent;window.rshlsetId=w().sync.setId;window.rshlsync=function(a,b){for(var c=a.split(","),e=b.split(","),f=0,g=a.length;f<g;f++)w().sync.execute(c[f],e[f])};window.rshlcontinue=function(){function a(b){if(!rspkr.HL.chunking.entracte.src){var b=encodeURIComponent(decodeURIComponent(rs.cfg.getPhrase(b))),c={noads:1},e;for(e in rspkr.c.data.params)rspkr.c.data.params.hasOwnProperty(e)&&(c[e]=rspkr.c.data.params[e]);e=rspkr.Common.data.selectedText;
var f=rspkr.Common.data.selectedHTML;rspkr.Common.data.selectedText=b;rspkr.Common.data.selectedHTML="";c.text=b;c.output="audio";b=rspkr.c.buildReadSpeakerCall(c);rspkr.HL.chunking.entracte.src=b;rspkr.Common.data.selectedText=e;rspkr.Common.data.selectedHTML=f}rspkr.HL.chunking.entracte.volume=parseFloat((rspkr.st.get("hlvol")||100)/100);rspkr.pl.playPromise(rspkr.HL.chunking.entracte)}if(rspkr.HL.chunking){rspkr.log("[rspkr.ui.rshlcontinue]");rspkr.HL.chunking.chunkEnded=!0;var b=$rs.get("#sync"+
rspkr.HL.html5.synclist[rspkr.HL.html5.synclist.length-2][2]);$rs.isArray(b)&&!b.length?(b=0,document.body&&document.body.scrollTop?b=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?b=document.documentElement.scrollTop:window.pageYOffset&&(b=window.pageYOffset),b={left:rs.ui.viewport.width/2,top:rs.ui.viewport.height/2+b}):b=$rs.offset(b);if(rspkr.HL.chunking.continueHref){var c=rspkr.cfg.item("cb.chunking.pause",void 0,!0);if(-1==rspkr.HL.chunking.continueTime)if(rspkr.log("[rspkr.ui.rshlcontinue] Waiting for user interaction"),
rs.ui.getActivePlayer().pause(),$rs.addClass(rspkr.ui.getActivePlayer().getContainer(),"rsautopaused"),a("chunkcontinue"),c&&"function"==typeof c)rspkr.log("[rspkr.ui.rshlcontinue] Running custom callback",3),c();else{rspkr.log("[rspkr.ui.rshlcontinue] Showing default continue button");c=document.createElement("div");c.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");$rs.addClass(c,rspkr.ui.rsbtnClass+" rspopup rsresume");var e=$rs.findIn(c,"a");e.removeAttribute("href");$rs.regEvent(e,"click",
function(){rspkr.c.dispatchEvent("onChunkResume",window)});$rs.findIn(e,".rsbtn_text").innerHTML="<span>"+rs.cfg.getPhrase("chunkbutton")+"</span>";document.body.appendChild(c);c.style.display="block";b.left+=15;e=b.left+$rs.width(c)-$rs.width(window);0<e&&(b.left-=e);c.style.left=b.left+"px";c.style.top=b.top+15+"px"}else 0==rspkr.HL.chunking.continueTime?(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay"),rspkr.c.dispatchEvent("onChunkResume",window)):isNaN(rspkr.HL.chunking.continueTime)?rspkr.log("[rshlcontinue] Invalid time parameter!",
3):(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay with "+rspkr.HL.chunking.continueTime+" seconds delay"),5<=rspkr.HL.chunking.continueTime&&a("chunkwait"),c&&"function"==typeof c&&c(rspkr.HL.chunking.continueTime),rspkr.HL.chunking.stall=!0,setTimeout(function(){rspkr.HL.chunking.stall=!1},1E3*rspkr.HL.chunking.continueTime),rspkr.HL.chunking.timer=setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},1E3*rspkr.HL.chunking.continueTime))}else rspkr.log("[rshlcontinue] No continue href found!")}};
var b=rspkr.c.data.browser;b&&(/iphone|ipad|ios|android|windows phone/i.test(b.OS)||"android"==b.name.toLowerCase())?($rs.regEvent(document.body,"touchstart",function(a){rspkr.ui.setPointerPos(a);return!0}),$rs.regEvent(document.body,"touchend",function(a){rspkr.ui.setPointerPos(a);rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document,"selectionchange",function(a){rspkr.c.data.setSelectedText(a);return!0})):($rs.regEvent(document.body,"mousedown",function(a){rspkr.ui.setPointerPos(a);return!0}),
$rs.regEvent(document.body,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(window,"mouseup",function(a){"opera"===b.name.toLowerCase()?setTimeout(function(){rspkr.c.data.setSelectedText(a)},50):rspkr.c.data.setSelectedText(a);return!0}),$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(a){rspkr.c.data.setSelectedText(a);return!0}))},
j=function(){document.removeEventListener?document.removeEventListener("click",window.ReadSpeakerDefer.clickhandler,!1):document.detachEvent&&document.detachEvent("onclick",window.ReadSpeakerDefer.clickhandler);if(ReadSpeakerDefer.deferred){var a=ReadSpeakerDefer.deferred,b=null;if("a"!=a.tagName.toLowerCase()){for(b=a;"body"!=b.tagName.toLowerCase()&&!(b=b.parentNode,"a"==b.tagName.toLowerCase()););a=b}ReadSpeakerDefer.isRSLink(a)&&(rspkr.log("[rspkr.ui] Activating deferred element: "+a),$rs.removeClass(a.parentNode,
"rsdeferred"),rspkr.ui.showPlayer(a));ReadSpeakerDefer.deferred=null}},f=null,g=function(){f&&$rs.isVisible(f)&&(rspkr.log("[rspkr.ui.updateFocus] "+f.outerHTML),m(f))},m=function(a){$rs.focus&&("function"==typeof $rs.focus&&a)&&$rs.focus(a)},l=function(a){if("iconon"==rspkr.st.get("hlicon")&&!h){var b=c.push(new v)-1;c[b].id=b;c[b].show(a);h=!0}},n=function(){"iconon"==rspkr.st.get("hlicon")&&h&&(c.pop().hide(),h=!1)},v=function(){var a=0,b=0,f=null,g=52,j=null,l=null,n=null,k=function(a){a=a||f;
$rs.addClass(a,rspkr.ui.rsbtnClass+" rspopup");rspkr.cfg.item("general.useCompactPopupButton")&&$rs.addClass(a,"rscompact")},v=function(a){$rs.unregEvent(f,"mouseout",q);window.clearTimeout(j);var b,c=f.clientWidth+10,g;l=rspkr.ui.showPlayer(n,f,!0);g=l.getWidth();b=parseInt($rs.offset(f).left);if((b=rspkr.ui.viewport.width+$rs.scrollLeft(document)-b)<g)b=parseInt($rs.css(f,"left"))-(g-(c-10)),$rs.css(f,"left",b+"px");h=!1;$rs.unregEvent(n,"click",v);$rs.regEvent(n,"click",function(a){e(a);return l.restart()});
e(a);return!1},q=function(){j||(j=window.setTimeout(function(){p()},rspkr.cfg.item("general.popupCloseTime")||2E3))},t=function(){j&&(window.clearTimeout(j),j=null)},m=function(a,b){$rs.css(f,{top:b+"px",left:a+"px",width:g+"px"})},p=function(){$rs.css(f,{display:"none",top:0,left:0});t();c.splice(null,1);h=!1;f.parentElement.removeChild(f)},w=rspkr.c.findFirstRSButton(),f=document.createElement("div");f.id=rspkr.getID();f.innerHTML=rspkr.cfg.item("ui.popupbutton").join("");k();n=$rs.findIn(f,".rsbtn_play");
$rs.setAttr(n,"href",w?$rs.getAttr(w,"href"):null);(w=rspkr.cfg.item("general.popupHref"))&&$rs.setAttr(n,"href",w);var w=$rs.getAttr(n,"href").match(/lang=([^&;]*)/i).pop(),C=$rs.findIn($rs.get(f),".rsbtn_play span.rsbtn_text span");C&&(C.textContent=C.innerText=rspkr.cfg.getPhrase("listen",w,"en_us"));$rs.setAttr(n,"title",rspkr.cfg.getPhrase("listentoselectedtext",w,"en_us"));$rs.regEvent(n,"click",v);document.body.appendChild(f);return{setPos:m,show:function(c){t(c);if(c&&"none"==$rs.css(f,"display")){var e=
f.cloneNode(!0);e.id=rspkr.getID();$rs.css(e,{display:"block",position:"absolute",top:0,left:0});document.body.appendChild(e);g=$rs.outerWidth(e)+3;document.body.removeChild(e);e=c.pageX||c.clientX+document.body.scrollLeft||rspkr.ui.pointerX;c=c.pageY||c.clientY+document.body.scrollTop||rspkr.ui.pointerY;b=c>rspkr.ui.pointerY?c-$rs.scrollTop(document)+36>rspkr.ui.viewport.height-46?c-66:c+30:10>c-$rs.scrollTop(document)-66?c+30:c-51;a=10>e-$rs.scrollLeft(document)?e+10:e-$rs.scrollLeft(document)>
rspkr.ui.viewport.width-(g+10)?rspkr.ui.viewport.width+$rs.scrollLeft(document)-(g+10):e+0;m(a,b)}$rs.regEvent(f,"mouseout",q);$rs.regEvent(f,"mouseover",t);q(null);k();$rs.css(f,"display","block")},hide:p,id:null}},q={update:function(b,c,e){"hlspeed"===b&&c!==e&&(b=b.replace("hl",""),rspkr.c.converter[b]&&"function"==typeof rspkr.c.converter[b]&&(c=rspkr.c.converter[b](c)),rspkr.c.data[b]=c,a&&a.stop(),rspkr.pl.releaseAdapter())}},t=function(a,b,c,e,f,g){$rs.css(a,"background-color","rgb("+b+","+
c+","+e+")");e<f?(e+=10,window.setTimeout(function(){t(a,b,c,e,f,g)},50)):g&&"function"===typeof g&&g.apply(a,[])},w=function(){return rspkr.XP?rspkr.XP:rspkr.HL};_expand=function(a){"string"==typeof a&&(a=$rs.get(a));$rs.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++)rspkr.ui.Player(a[b]).show(!0)};_animate=function(){var a=rs.cfg.item("ui.animate");if(a){var b,c=15,e=500;"object"==typeof a?(a.id&&(b=$rs.get(a.id)),a.count&&(c=a.count),a.interval&&(e=a.interval)):"string"===typeof a&&(b=$rs.get(a));
if("boolean"===typeof a&&a||$rs.isArray(b)&&0==b.length||!b)b=$rs.get("."+rs.ui.rsbtnClass);$rs.isArray(b)||(b=[b]);var f=c,g=setInterval(function(){0==f&&($rs.removeClass(b,"rsanimate"),clearInterval(g));1==f--%2?$rs.addClass(b,"rsanimate"):$rs.removeClass(b,"rsanimate")},e)}};return{meta:{revision:"5565"},initrun:!1,init:function(){var a=rspkr.Common.addEvent;a("onAfterModsLoaded",p);a("onReady",k);a("onReady",j);a("onReady",_animate);a("onSelectedText",l);a("onDeselectedText",n);a("onSettingsChanged",
q.update);a("onAfterSyncInit",g);this.initrun=!0;rspkr.Common.dispatchEvent("onUIInitialized");rspkr.log("[rspkr.ui] Initialized!")},addFocusHandler:function(a,b,c){var e=b,g=c,g=g||a;void 0===e&&(e=!0);$rs.focusIn&&"function"==typeof $rs.focusIn&&($rs.focusIn(a,function(){$rs.addClass(g,"rsfocus");!0===e&&(f=a);rspkr.Common.dispatchEvent("onFocusIn",window,[a,g])}),$rs.focusOut(a,function(){$rs.removeClass(g,"rsfocus");rspkr.Common.dispatchEvent("onFocusOut",window,[a,g])}))},focus:function(a){m(a)},
updateFocus:function(){g()},showOverlay:function(b,c){var f=b,g;g=c||a.getContainer();var h=$rs.findIn(g,".rsbtn_status");0===h.length&&(h=document.createElement("span"),h.className="rsbtn_status_overlay",h.innerHTML='<span class="rsbtn_status"></span>',$rs.findIn(g,".rsbtn_exp").appendChild(h),h=$rs.findIn(g,".rsbtn_status"));$rs.css($rs.findIn(g,".rsbtn_status_overlay"),"display","block");if("nosound"===f)f='<a class="rsbtn_nosound">'+rspkr.cfg.getPhrase("nosound")+"</a>",h.innerHTML=f,(f=$rs.findIn(g,
".rsbtn_nosound"))&&$rs.regEvent(f,"click",function(){return a.nosound()});else if("loaderror"===f){var f=rspkr.c.data.getSaveData("link"),j=document.createElement("a");j.className="rsbtn_loaderror";j.innerHTML=rspkr.cfg.getPhrase("nosoundlink")||"[?]";j.href=f;$rs.regEvent(j,"click",function(a){rspkr.ui.Lightbox.show("<iframe src='"+j.href+"' style='height:100%'></iframe>",null,!1,null,300);e(a)});h.innerHTML=rspkr.cfg.getPhrase("loaderror")||"An error has occurred, try again";h.appendChild(j)}else h.innerHTML=
f},settings:q,rsbtnClass:"",addClickEvents:function(){k()},initGlobalCallbacks:function(){p()},showPopupIcon:function(a){l(a)},processDeferred:function(){j()},showPlayer:function(c,e,f){var g;a:{var h=f;rspkr.log("[rspkr.ui.showPlayer]");h=h||!1;if("string"==typeof c)b:{for(var f=$rs.get("a"),j=0,l=f.length;j<l;j++)if(f[j].href&&f[j].href==c){f=f[j];break b}f=!1}else f=c;f=(j=f)?$rs.closest(j,".rsexpanded"):void 0;if((f=$rs.hasClass(f,"pre-expanded")?void 0:f)&&!$rs.isArray(f)&&rspkr.ui.getActivePlayer()&&
1==rspkr.HL.chunking.currentChunkNumber&&rspkr.ui.getActivePlayer().getContainer()==f)rspkr.HL.newPlayback=!1,rspkr.log("Player already active, calling Player.restart() instead"),rspkr.ui.getActivePlayer().restart(),g=void 0;else{rspkr.HL.lpSelection&&rspkr.HL.sync.fullCleanUp();0<rspkr.c.data.selectedText.length?(rspkr.HL.lpSelection=!0,rspkr.HL.newPlayback=!0,rspkr.HL.sync.lightCleanUp()):rspkr.HL.lpSelection?(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=!0):(rspkr.HL.lpSelection=!1,rspkr.HL.newPlayback=
!1);rspkr.HL.chunking.destroy();rspkr.HL.chunking&&rspkr.HL.chunking.html5support&&(rspkr.HL.chunking.entracte=new Audio,/safari|ios|ipad|iphone|ipod|android|windows phone/i.test(window.navigator.userAgent)&&rspkr.pl.playPromise(rspkr.HL.chunking.entracte,void 0,void 0,!0));rspkr.c.dispatchEvent("onBeforeParamsSet",window,[j]);f="string"==typeof c?c:$rs.getAttr(j,"href");l=null;"string"==typeof c&&(c=f.match(/readid=[^&]+/gi),l=f.match(/readclass=[^&]+/gi),c&&0<c.length&&rspkr.HL.Restore.Storage.readId.push(c[0].replace("readid=",
"").split(",")),l&&0<l.length&&rspkr.HL.Restore.Storage.readClass.push(l[0].replace("readclass=","").split(",")));rspkr.c.data.selectedHTML="";rspkr.c.data.setParams(f);void 0!==$rs.getAttr(j,"data-target")&&null!==$rs.getAttr(j,"data-target")&&(c=$rs.getAttr(j,"data-target"),c=$rs.get(c),"object"===typeof c&&(e=c));e&&!h?(l=$rs.get(e),$rs.addClass(l,rspkr.ui.rsbtnClass+" rsfloating"),rspkr.basicMode&&($rs.removeClass(l,"rshidden"),$rs.addClass(l,rspkr.ui.rsbtnClass+" rsvisible"))):l=$rs.closest(j,
"div."+rspkr.ui.rsbtnClass);if(!0===rspkr.cfg.item("survey.allowed"))if(e=rspkr.c.cookie,h=rspkr.cfg.item("survey.cookieName")||"rspkrsurvey",c=rspkr.cfg.item("survey.cookieLifetime")||15552E6,j=rspkr.c.data.params,"1"===e.readKey(h,"nmbrdisplays")){rspkr.ui.Lightbox.show(rspkr.cfg.item("survey.url")+"?customerid="+j.customerid+"&lang="+j.lang,rspkr.st.r().replaceTokens(rspkr.cfg.item("ui.survey.buttons").join(),{rsSURVEY_BUTTON_CLOSErs:rspkr.cfg.getPhrase("close")}),!0,function(){$rs.regEvent($rs.get("#rssurvey_button_close"),
"click",rspkr.u.Lightbox.hide)},500);rspkr.log(e.updateKey(h,"nmbrdisplays","displayed",c),4);g=void 0;break a}else void 0===e.readKey(h,"nmbrdisplays")&&rspkr.log(e.updateKey(h,"nmbrdisplays","1",c),4);b:{e=l;for(g in b)if(b[g]&&b[g].getContainer&&b[g].getContainer()==e){g=b[g];break b}g=new rspkr.ui.Player(e);b.push(g)}if(a&&a!=g||a&&f!==a.getHref())a.close(!0),rspkr.c.dispatchEvent("onUIClosePlayer",a.getContainer(),[0<rspkr.c.data.selectedText.length?"textsel":"nosel"]);e=(e=a)?e.getID():null;
rspkr.c.dispatchEvent("onUIShowPlayer",window,[e,g.getID()]);g.setHref(f);a=g;g.show();g=a}}return g},expand:function(a){_expand(a)},pointerX:0,pointerY:0,setPointerPos:function(a){a.pageX&&(rspkr.ui.pointerX=a.pageX);a.pageY&&(rspkr.ui.pointerY=a.pageY);a.originalEvent&&(a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageX)&&(rspkr.ui.pointerX=a.originalEvent.touches[0].pageX);a.originalEvent&&(a.originalEvent.touches&&a.originalEvent.touches[0]&&a.originalEvent.touches[0].pageY)&&
(rspkr.ui.pointerY=a.originalEvent.touches[0].pageY);return!0},viewport:{width:$rs.width(window),height:$rs.height(window)},popups:c,hl:function(a,b){window.setTimeout(function(){t(a,255,255,100,255,b)},200)},scroll:{INTERVAL:null,STEPS:25,scrollToElm:function(a){$rs.isVisible(a)&&this.initScroll(a)},scrollToAnchor:function(a){for(var b=$rs.get("a"),c=null,e=0;e<b.length;e++){var f=b[e];if(f.name&&f.name==a){c=f;break}}this.initScroll(c)},initScroll:function(a){if(a){if(rspkr.cfg.item("ui.extendedAutoScroll"))for(var b=
a.parentElement;b!==document.body;){if(b.scrollHeight>b.clientHeight){var c="Explorer"==rspkr.c.data.browser.name&&7>=rspkr.c.data.browser.version?a.offsetTop:a.offsetTop-b.offsetTop;if(b.scrollTop>c||c+a.offsetHeight>b.clientHeight){var e=b.scrollTop,f=c-e,g;if(window.requestAnimationFrame)window.requestAnimationFrame(function y(a){g||(g=a);var a=a-g,c=Math.min(a/1E3,1);b.scrollTop=e+f*c;1E3>a&&window.requestAnimationFrame(y)});else{clearInterval(rspkr.u.scroll.INTERVAL);var h=b.scrollTop,j=(c-h)/
rspkr.u.scroll.STEPS,l=0;rspkr.u.scroll.INTERVAL=setInterval(function(){b.scrollTop=h+l*j;l++;l>=rspkr.u.scroll.STEPS&&(b.scrollTop=c,clearInterval(rspkr.u.scroll.INTERVAL))},10)}}if(b.clientHeight<$rs.height(window))rspkr.u.scroll.scrollToElm(b);else break;return}b=b.parentElement}for(var n=a.offsetTop,k=a;k.offsetParent&&k.offsetParent!=document.body;)k=k.offsetParent,n+=k.offsetTop;n-=50;rs.cfg.item("ui.autoscrollOffset")&&!isNaN(rs.cfg.item("ui.autoscrollOffset"))&&(n-=rs.cfg.item("ui.autoscrollOffset"));
clearInterval(rspkr.u.scroll.INTERVAL);var k=rspkr.u.scroll.getCurrentYPos(),v=parseInt((n-k)/rspkr.u.scroll.STEPS);rspkr.u.scroll.INTERVAL=setInterval(function(){rspkr.u.scroll.scrollWindow(v,n,a)},10)}else document.location.hash=a},getCurrentYPos:function(){return document.body&&document.body.scrollTop?document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?document.documentElement.scrollTop:window.pageYOffset?window.pageYOffset:0},scrollWindow:function(a,b,c){var b=
Math.max(b,0),e=rspkr.u.scroll.getCurrentYPos(),f=e<b,g=!1;if("iOS"===rspkr.c.data.browser.OS){var h=document.body.getBoundingClientRect(),j=h.width==screen.width?screen.height:screen.width;b>h.height-j&&(b=h.height-j,g=!0)}window.scrollTo(0,e+a);a=rspkr.u.scroll.getCurrentYPos();if(f!=a<b||e==a||g)window.scrollTo(0,b),clearInterval(rspkr.u.scroll.INTERVAL),"string"==typeof c&&(location.hash=c)}},activePlayer:a,getActivePlayer:function(){return a}}}();
ReadSpeaker.ui.Slider=function(){var a=this,b={handleClass:"",width:0,height:0,left:0,top:0,steps:-1,stepsize:-1,dir:"h",initval:-1,drop:null,start:null,dragging:null,click:null,labelDragHandle:"",labelStart:"",labelEnd:"",nudge:1},c={rsid:void 0,parent:void 0,ref:void 0},h=void 0,e=void 0,k=void 0,p=void 0,j=void 0,f=!1,g=0,m=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()};
this.initElement=function(a){if(!f){"string"==typeof a&&(a=document.getElementById(a));a.innerHTML+='<a href="javascript:void(0);" role="slider" class="keyLink" style="display:block; border:0;">&#160;</a>';var e=a.getElementsByTagName("a"),e=e[e.length-1],h=-1<b.steps?b.steps:100;e.relatedElement=a;$rs.setAttr(e,"title",b.labelDragHandle);try{$rs.setAttr(e,"aria-label",b.labelDragHandle),$rs.setAttr(e,"aria-orientation","h"==b.dir?"horizontal":"vertical"),$rs.setAttr(e,"aria-valuemin",0),$rs.setAttr(e,
"aria-valuemax",h),$rs.setAttr(e,"aria-valuenow",b.initval||0)}catch(j){}g=b.initval;$rs.regEvent(a,"mousedown",this.startDragMouse);$rs.regEvent(e,"click",function(a){m(a)});$rs.regEvent(e,"keyup",this.startDragKeys);$rs.regEvent(e,"dragstart",function(a){m(a)});$rs.regEvent(a,"touchstart",this.touchStart);$rs.regEvent(c.parent,"mousedown",this.mouseClick)}};this.mouseClick=function(e){if(!f&&!$rs.hasClass(c.ref,"dragged")){var g=a.findPos(e.target),h=e.clientX-(g.left-b.left),e=e.clientY-(g.top-
b.top);k=g.left;p=g.top;g=a.getCurrentVal({left:h,top:e});"function"==typeof b.click&&b.click(g,c);return!1}};this.findPos=function(a){var b=curTop=0;if(a.offsetParent){do b+=a.offsetLeft,curTop+=a.offsetTop;while(a=a.offsetParent);return{left:b,top:curTop}}};this.startDragMouse=function(b){rspkr.log("[rspkr.ui.Slider] startDragMouse");if(!f){a.startDrag(this);var c=b||window.event;h=c.clientX;e=c.clientY;$rs.regEvent(document.body,"mousemove",a.dragMouse);$rs.regEvent(document.body,"mouseup",a.releaseElement)}m(b);
return!1};this.startDragKeys=function(b){rspkr.log("[rspkr.ui.Slider] startDragKeys "+(b||window.event).keyCode);a.startDrag(this.relatedElement);$rs.regEvent(document.body,"keydown",a.dragKeys);$rs.regEvent(document.body,"keypress",a.switchKeyEvents);$rs.addClass(this.relatedElement,"rskeycontrolled");m(b)};this.touchStart=function(b){b=b.originalEvent;rspkr.log("[rspkr.ui.Slider] touchStart");f||(a.startDrag(b.target),h=b.touches[0].pageX,e=b.touches[0].pageY,$rs.regEvent(b.target,"touchmove",a.touchMove),
$rs.regEvent(b.target,"touchend",a.releaseElement));return!1};this.startDrag=function(e){rspkr.log("[rspkr.ui.Slider] startDrag");j&&a.releaseElement();k=e.offsetLeft;p=e.offsetTop;j=e;$rs.addClass(j,"dragged");"function"==typeof b.start&&b.start(c)};this.dragMouse=function(b){b=b||window.event;a.setPosition(b.clientX-h,b.clientY-e);a.valueChanged=!0;return!1};this.touchMove=function(b){b=b.originalEvent?b.originalEvent:b;m(b);a.setPosition(b.touches[0].pageX-h,b.touches[0].pageY-e);a.valueChanged=
!0;return!1};this.dragKeys=function(e){switch((e||window.event).keyCode){case 37:case 63234:a.valueChanged=!0;g-=b.nudge;break;case 38:case 63232:a.valueChanged=!0;g+=b.nudge;break;case 39:case 63235:a.valueChanged=!0;g+=b.nudge;break;case 40:case 63233:a.valueChanged=!0;g-=b.nudge;break;case 13:case 27:return a.releaseElement(),!1;case 9:return a.releaseElement(),!0;default:return rspkr.log("[rspkr.ui.Slider] return TRUE"),!0}!0===a.valueChanged&&(rspkr.c.dispatchEvent("onUISliderMove"),"function"==
typeof b.dragging&&b.dragging(a.getCurrentVal({skipValueCalculation:!0}),c));m(e);rspkr.log("[rspkr.ui.Slider] ready to return!");return!1};this.setPosition=function(e,f){var g,h=!1;g=e;var t=k,m=b.left,r=b.width,u="left";"v"==b.dir&&(g=f,t=p,m=b.top,r=b.height,u="top");g=t+g;-1<b.stepsize&&((g+m)%b.stepsize?g=b.stepsize*Math.ceil(g/b.stepsize)+m:h=!0);g>r+m?g=r+m:g<m&&(g=m);h||(j.style[u]=g+"px","function"==typeof b.dragging&&b.dragging(a.getCurrentVal(),c))};this.switchKeyEvents=function(){$rs.unregEvent(document.body,
"keydown",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.regEvent(document.body,"keypress",a.dragKeys)};this.releaseElement=function(){rspkr.log("[rspkr.ui.Slider] releaseElement");$rs.unregEvent(document.body,"mousemove",a.dragMouse);$rs.unregEvent(document.body,"mouseup",a.releaseElement);$rs.unregEvent(document.body,"keypress",a.dragKeys);$rs.unregEvent(document.body,"keypress",a.switchKeyEvents);$rs.unregEvent(document.body,"keydown",a.dragKeys);$rs.unregEvent(j,"touchmove",
a.touchMove);$rs.unregEvent(j,"touchend",a.releaseElement);$rs.removeClass(j,"dragged");$rs.removeClass(j,"rskeycontrolled");$rs.removeClass(j,"rsmousecontrolled");var e=a.getCurrentVal();j=null;"function"==typeof b.drop&&!0===a.valueChanged&&b.drop(e,c);a.valueChanged=!1;rs.ui.getActivePlayer()&&rs.ui.getActivePlayer().setProgress();return!1};this.getCurrentVal=function(a){var e,f=b.width;e="left";var h=b.left;"v"==b.dir&&(f=b.height,e="top",h=b.top);var j=-1<b.steps?b.steps:100,f=-1<b.stepsize?
b.stepsize:f/j,a=a?a[e]:$rs.css(c.ref,e).replace(/px/i,"");pos=Math.round(a)-h;e=Math.round(pos/f);"v"==b.dir&&(e=j-e);rspkr.log("[rspkr.ui.Slider] currentval: "+e);return a&&a.skipValueCalculation||isNaN(e)?g=Math.max(Math.min(g,j),0):g=e};return{init:function(e,f){"string"==typeof e&&(e=document.getElementById(e));if(e){var g=e.id||"data-readspeaker-slider-id-"+Math.floor(2E4*Math.random());e.setAttribute&&e.setAttribute("data-readspeaker-slider-id-","data-readspeaker-slider-parent-"+g);var h={width:function(){return $rs.width(e)},
height:function(){return $rs.height(e)}};if("object"==typeof f)for(var j in f)f.hasOwnProperty(j)&&void 0!==b[j]&&(b[j]=f[j]);j=!1;var k;"rsbtn_volume_slider"===e.className&&("jquery"===rspkr.l.f.currentLib()&&1.5>parseFloat(jQuery.fn.jquery))&&(k=e.parentNode.style.display,e.parentNode.style.display="block",j=!0);b.width=h.width();b.height=h.height();j&&(e.parentNode.style.display=k);-1<b.steps&&(b.stepsize=("h"==b.dir?b.width:b.height)/b.steps);h=document.createElement("span");h.setAttribute("data-readspeaker-slider-id-",
g);h.className=b.handleClass||"rsbtn_progress_handle rsimg";e.appendChild(h);c.rsid=g;c.parent=e;c.ref=h;g=$rs.css(h,"left");null!==g&&(b.left=parseInt(g.replace(/px/i,"")));g=$rs.css(h,"top");null!==g&&(b.top=parseInt(g.replace(/px/i,"")));-1<b.initval&&this.jumpTo(b.initval);b.labelStart&&(g=document.createElement("span"),g.className="slider-label-start",g.innerHTML=b.labelStart,e.appendChild(g));b.labelEnd&&(g=document.createElement("span"),g.className="slider-label-end",g.innerHTML=b.labelEnd,
e.appendChild(g));a.initElement(h)}},jumpTo:function(a){if(isNaN(a))return!1;var e=101,f=a;-1<b.steps&&(a=Math.round(a),e=b.steps+1);if(-1<a&&a<e){var g=b.width,h=b.left,j="left";"v"==b.dir&&(g=b.height,h=b.top,j="top",a=e-1-a);c.ref.style[j]=g/(e-1)*a+h+"px";$rs.setAttr($rs.findIn(c.ref,"a.keyLink"),"aria-valuenow",f)}},setCurrentValue:function(a){g=a},getInstance:function(){return c},getContainer:function(){return c.parent},releaseElement:function(){a.releaseElement()},startDragKeys:function(b,
c){a.startDragKeys.call(b,c)},disabled:function(){if(arguments)f=arguments[0];else return f}}};
ReadSpeaker.ui.Player=function(a){var b=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},c=rspkr.getID(),h=this,e=[],k=0,p=!1,j=null,f=!1,g={_play:null,_pause:null,_stop:null,_vol:null,_settings:null,_dl:null,_closer:null,_powered:null,_get:function(b,c){var e,b="_"+b;e=a?this[b]&&0<this[b].length?this[b]:this[b]=$rs.findIn(a,c):null;return e==[]?null:e},play:function(){return this._get("play",
".rsbtn_play")},pause:function(){return this._get("pause",".rsbtn_pause")},stop:function(){return this._get("stop",".rsbtn_stop")},vol:function(){return this._get("vol",".rsbtn_volume")},settings:function(){return this._get("settings",".rsbtn_settings")},dl:function(){return this._get("dl",".rsbtn_dl")},pin:function(){return this._get("pin",".rsbtn_pin")},powered:function(){return this._get("powered",".rsbtn_powered")},closer:function(){return this._get("closer",".rsbtn_closer")},nosound:function(){return this._get("nosound",
".rsbtn_nosound")},setPlayPause:function(a){rspkr.log("[rspkr.ui.Player.setPlayPause("+a+")]");a=a?$rs.getAttr(this.pause(),"data-rsphrase-play"):$rs.getAttr(this.pause(),"data-rsphrase-pause");$rs.setAttr(this.pause(),"title",rspkr.c.decodeEntities(a));$rs.findIn(this.pause(),".rsbtn_btnlabel").innerHTML=a}},m=!1,l=[],n={play:function(){rspkr.c.dispatchEvent("onUIBeforePlay");rspkr.log("[rspkr.ui.handlers.play]");l.progress&&l.progress.disabled(!1);n.setStateClass(a,"rsplaying");rspkr.basicMode&&
n.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsplaying");$rs.addClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");g.setPlayPause(!1);if(rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().getContainer()==a)rspkr.pl.play(),f&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,q,h]),rspkr.c.addEvent("onBeforeSyncInit",function(){f=!0;rspkr.pl.getProgress.apply(rspkr.pl,[!0,q,h])}),"flash"===rspkr.pl.adapter&&!rspkr.displog.onVolumeAdjusted&&rspkr.pl.setVolume(parseInt(rspkr.st.get("hlvol")||"100")),
rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.cfg.execCallback("cb.ui.play",a);else{rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close();var b=$rs.findIn(a,".rsbtn_play");window.readpage(b)}},pause:function(){rspkr.log("[rspkr.ui.handlers.pause]");n.setStateClass(a,"rspaused");rspkr.basicMode&&n.setStateClass($rs.findIn(a,".rsbtn_exp"),"rspaused");g.setPlayPause(!0);rspkr.pl.pause();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIPause");rspkr.cfg.execCallback("cb.ui.pause",a);rspkr.log("ReadSpeaker.ui.pause")},
stop:function(){rspkr.log("[rspkr.ui.handlers.stop]");l.progress&&l.progress.disabled(!0);n.setStateClass(a,"rsstopped");$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading");rspkr.basicMode&&n.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped");g.setPlayPause(!0);$rs.setAttr(a,"data-readspeaker-current",0);l.progress&&(l.progress.jumpTo(0),v(0));rspkr.pl.stop();rspkr.pl.getProgress(!1);rspkr.c.dispatchEvent("onUIStop",a);rspkr.cfg.execCallback("cb.ui.stop",a);(!document.getElementById("rslightbox_contentcontainer")||
!$rs.isVisible(document.getElementById("rslightbox_contentcontainer")))&&g.pause().focus();rspkr.HL.chunking&&1<rspkr.HL.chunking.currentChunkNumber&&(rspkr.HL.chunking.destroy(),rspkr.pl.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter());rspkr.log("ReadSpeaker.ui.stop")},setStateClass:function(a,b){a&&($rs.removeClass(a,"rspaused rsstopped rsplaying"),$rs.addClass(a,b))},vol:function(b){var c=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(a,".rsbtn_volume"),b=b.originalEvent,f=function(a){var b=
a.originalEvent,b=$rs.closest(b.srcElement||b.originalTarget,".rsbtn_volume_container");if("click"===a.type){if(void 0===b||$rs.isArray(b)&&!b.length)$rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f)}else"keyup"===a.type&&27===a.keyCode&&($rs.css(c,"display","none"),$rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f))};$rs.css(c,"left",e.offsetLeft+"px");$rs.css(c,"display","none"==$rs.css(c,"display")?"block":"none");
"block"===$rs.css(c,"display")?($rs.regEvent(document.body,"click",f),$rs.regEvent(document.body,"keyup",f)):($rs.unregEvent(document.body,"click",f),$rs.unregEvent(document.body,"keyup",f));b&&b.stopPropagation&&b.stopPropagation();b.cancelBubble=!0;e={keyCode:13};b=$rs.findIn(c,".keyLink");try{l.vol.startDragKeys(b,e)}catch(g){rspkr.log("[rspkr.ui.handlers.vol] Error accessing object _sliders['vol']")}return!1},settings:function(){$rs.hasClass(a,"rsplaying")&&this.pause();rspkr.ui.Lightbox.show(rspkr.st.getHTML(),
rspkr.st.getButtons(),!0,function(a){var b=$rs.get("rslightbox_closer"),c=function(){document.removeEventListener?b.removeEventListener("click",c,!1):document.detachEvent&&document.detachEvent("onclick",c);rspkr.c.dispatchEvent("onSettingsClosed",window,[])};$rs.regEvent(b,"click",c);rspkr.ui.addClickEvents();rspkr.c.dispatchEvent("onSettingsLoaded",window,[]);rspkr.cfg.execCallback("cb.ui.settingsopened",a)})},close:function(b){n.pin(!0);var b=b||!1,c=rspkr.pl,e=!1;rspkr.HL.chunking.destroy();b||
rspkr.cfg.execCallback("cb.ui.beforeclose",a);c.hasOwnProperty("getProgress")&&rspkr.pl.getProgress(!1);c.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter();$rs.setAttr(a,"data-readspeaker-current",0);l.progress&&(l.progress.jumpTo(0),v(0));$rs.removeClass(a,"rsstopped rsplaying rspaused rsexpanded");if(rspkr.basicMode){var f;(f=$rs.findIn(a,".rsbtn_play"))&&$rs.removeClass(f,"rsexpanded")}$rs.hasClass(a,"rsfloating")&&($rs.removeClass(a,rspkr.ui.rsbtnClass),rspkr.basicMode&&($rs.removeClass(a,
"rsvisible"),$rs.addClass(a,"rshidden")));g.setPlayPause(!0);$rs.hasClass(a,"rspopup")&&(e=!0,$rs.removeClass(a,"rspopup"),$rs.css(a,"display","none"),a.parentNode.removeChild(a));$rs.css(a,"width","auto");delete rspkr.displog.onVolumeAdjusted;b||(rspkr.c.dispatchEvent("onUIClosePlayer",a,["userclick"]),rspkr.cfg.execCallback("cb.ui.close",a),rspkr.log("ReadSpeaker.ui.close: "+a));!b&&!1===e&&rspkr.ui.focus($rs.findIn($rs.get(a),".rsbtn_play"))},dl:function(){$rs.hasClass(a,"rsplaying")&&this.pause();
var c=$rs.getAttr($rs.findIn(a,".rsbtn_play"),"href"),e=c?rspkr.c.data.getSaveData("dialog",c):rspkr.c.data.getSaveData("dialog"),f=!1;rspkr.log("[rspkr.ui.handlers.dl] Savelink: "+e);rspkr.u.Lightbox.show(this.getDlDialog(),this.getDlButtons(),!0,function(){var a=$rs.get("#rsdl_button_accept"),c=$rs.get("#rsdl_button_decline");a&&$rs.regEvent(a,"click",function(b){rspkr.u.Lightbox.hide(b);f="iOS"!==rspkr.c.data.browser.OS&&0<rspkr.c.data.selectedHTML.length?!0:"iOS"!==rspkr.c.data.browser.OS&&!0===
rspkr.cfg.item("general.usePost")?!0:!1;if(!0===f){b=null;if(document.getElementById("dliframe"))b=document.getElementById("dliframe");else{if(document.selection)try{b=document.createElement('<iframe name="dliframe">')}catch(c){b=document.createElement("iframe")}else b=document.createElement("iframe");b.name="dliframe";b.setAttribute("id","dliframe");b.setAttribute("style","display: none; position: absolute;");b.setAttribute("sandbox","");b.style.display="none";var g=document.getElementsByTagName("body"),
h=null;0<g.length&&(h=g.item(0));if(h)h.appendChild(b);else return}b.src=e;return!1}$rs.setAttr(a,"href",e);return!0});c&&($rs.regEvent(c,"click",function(a){b(a);rspkr.u.Lightbox.hide(a)}),setTimeout(function(){rspkr.ui.focus(c)},200));rspkr.c.dispatchEvent("onDownloadLoaded",window,[])})},pin:function(b,c){var e=a.id+"_pinnedHome",f=document.getElementById(e),c=!c?!1:!0;if(!$rs.hasClass(g.pin(),"pinned")&&!b){if($rs.addClass(g.pin(),"pinned"),!f){var h=function(a,b){return window.getComputedStyle?
window.getComputedStyle(a)[b]:a.currentStyle?a.currentStyle[b]:a.style[b]},f=$rs.clone(a,!1,!0),j=a.offsetLeft,k=a.offsetTop;if(!c){f.style.width=h(a,"width").replace(/[^-\d\.]/g,"")-2+"px";f.style.height=h(a,"height").replace(/[^-\d\.]/g,"")-2+"px";for(var n="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" "),l=0,m;m=n[l];l++){var p=$rs.css(a,m);$rs.setAttr(a,"data-css-"+m,p);p=h(a,m);"auto"!=p&&(f.style[m]=p)}f.className="rsbtn_pinnedHome rsbtn";for(f.id=
e;f.hasChildNodes();)f.removeChild(f.lastChild);a.parentElement.insertBefore(f,a)}a.style.position="fixed";a.style.top=k-$rs.scrollTop(document)+"px";a.style.left=j-$rs.scrollLeft(document)+"px"}}else if($rs.hasClass(g.pin(),"pinned")||b)if($rs.removeClass(g.pin(),"pinned"),f){f.parentNode.removeChild(f);n="position left right top bottom margin-left margin-right margin-top margin-bottom".split(" ");for(l=0;m=n[l];l++)p=$rs.getAttr(a,"data-css-"+m),$rs.css(a,m,p)}},getDlDialog:function(){var a=rspkr.cfg.item("ui.dldialog").join("\n"),
b={};b.rsTERMS_OF_USE_HEADINGrs=rspkr.cfg.getPhrase("touheading");b.rsTERMS_OF_USE_BODYrs=rspkr.cfg.getPhrase("toubody");return rspkr.st.r().replaceTokens(a,b)},getDlButtons:function(){var a=rspkr.cfg.item("ui.dlbuttons").join("\n"),b={};b.rsTERMS_OF_USE_ACCEPTrs=rspkr.cfg.getPhrase("touaccept");b.rsTERMS_OF_USE_DECLINErs=rspkr.cfg.getPhrase("toudecline");return rspkr.st.r().replaceTokens(a,b)},nosound:function(){var a=rspkr.c.data.getSaveData("link");$rs.setAttr(g.nosound(),"href",a);return!0}},
v=function(b){var b=100<b?100:b,c=$rs.findIn(a,".rsbtn_progress_played");"object"===typeof c&&$rs.css(c,"width",b+"%");rspkr.cfg.execCallback("cb.ui.progresschanged",a,[b])},q=function(b){if(b.length){var c=parseInt(b[0]),b=parseInt(b[1]),e=0==b?0:Math.round(100*(c/b)),f=$rs.findIn(a,".rsbtn_current_time"),g=$rs.findIn(a,".rsbtn_total_time"),h,j;l.progress&&(l.progress.setCurrentValue(e),m||(l.progress.jumpTo(e),v(e),f&&(f.innerHTML=h=t(c)),g&&(g.innerHTML=j=t(b)),rspkr.cfg.execCallback("cb.ui.timeupdated",
a,[h,j])));rspkr.log("[rspkr.player.updateProgress] current time: "+c+" total time: "+b);$rs.setAttr(a,"data-readspeaker-current",c);$rs.setAttr(a,"data-readspeaker-buffered",b);0<c&&$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading")}},t=function(a){var a=a/1E3,b=parseInt(a%60),c=parseInt(a/60%60),a=parseInt(a/60/60%60);return(10>a?"0"+a:a.toString())+":"+(10>c?"0"+c:c.toString())+":"+(10>b?"0"+b:b.toString())},w=function(){m=!0},r=function(b){rspkr.log("_dropProgress ("+b+")",
5);b&&(b=b/100*$rs.getAttr(a,"data-readspeaker-buffered")/1E3,rspkr.pl.setProgress(b));m=!1},u=function(a){r(a)},x=function(b){rspkr.log("_dropVolume, "+b,5);b=0>b?0:20*b;l.vol&&l.vol.jumpTo(b/20);rspkr.pl.setVolume(b);rspkr.st.set("hlvol",b);rspkr.cfg.execCallback("cb.ui.volumechanged",a,[b]);return!1},z=function(b,c){if("keyLink"===b.className){var e="";$rs.hasClass(c,"rsbtn_volume_handle")?e="vol":$rs.hasClass(c,"rsbtn_progress_handle")&&(e="progress");var f={keyCode:13};l[e].startDragKeys(b,f)}else $rs.hasClass(c,
"rsbtn_volume")&&(f={keyCode:13},e=$rs.findIn(a,".rsbtn_volume_container"),e=$rs.findIn(e,".keyLink"),l.vol.startDragKeys(e,f))},B=function(a,b){if("keyLink"===a.className){var c="";$rs.hasClass(b,"rsbtn_volume_handle")?c="vol":$rs.hasClass(b,"rsbtn_progress_handle")&&(c="progress");l[c].releaseElement();m=!1}};return{init:function(){e.push([this.show,[]])},initVolume:function(){if(!$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))){var b=rspkr.cfg,c=rspkr.st.get("hlvol")||"100",c=5*(parseInt(c)/
100);l.vol=new rspkr.ui.Slider;l.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:b.item("ui.volumeHandleClass")||"rsbtn_volume_handle rsimg",dir:b.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:c,dragging:x,click:x,labelDragHandle:b.getPhrase("slidervolumedesc")});b=$rs.findIn($rs.get(a),".rsbtn_volume_handle a");ui.addFocusHandler(b,!1,b.parentNode)}},show:function(e){var e=e?!0:!1,f=$rs.hasClass(a,"rsexpanded");$rs.rsid(a);a.id=c=a.id||rspkr.getID();ui=rspkr.ui;$rs.hasClass(a,rspkr.ui.rsbtnClass)||
$rs.addClass(a,rspkr.ui.rsbtnClass);var h=null,h=rspkr.cfg,j=rspkr.cfg.getPhrases(rspkr.c.data.getParam("lang"));if(0==$rs.findIn(a,".rsbtn_exp").length){var m=$rs.hasClass(a,"rspopup")?h.item("ui.popupplayer"):h.item("ui.player"),h=document.createElement("div");h.className="rsbtn_exp rsimg rspart";h.innerHTML+=m.join("\n");a.appendChild(h)}h=g.pin();m="Explorer"==rspkr.c.data.browser.name&&8>rspkr.c.data.browser.version;$rs.isArray(h)&&0==h.length&&(h=void 0);h&&!m&&rspkr.cfg.item("ui.usePin")?$rs.removeClass(h,
"turnedOff"):h&&h.parentElement.removeChild(h);if(j){h=function(a,b){var c=$rs.findIn(a,".rsbtn_btnlabel");$rs.isArray(c)||(c=[c]);0<c.length&&(c[0].innerHTML=b)};g.pause()&&($rs.setAttr(g.pause(),"data-rsphrase-pause",j.pause),$rs.setAttr(g.pause(),"data-rsphrase-play",j.play),$rs.setAttr(g.pause(),"title",rspkr.c.decodeEntities(j.pause)),h(g.pause(),rspkr.c.decodeEntities(j.pause)));g.stop()&&($rs.setAttr(g.stop(),"title",rspkr.c.decodeEntities(j.stop)),h(g.stop(),rspkr.c.decodeEntities(j.stop)));
g.vol()&&($rs.setAttr(g.vol(),"title",rspkr.c.decodeEntities(j.volume)),h(g.vol(),rspkr.c.decodeEntities(j.volume)));g.settings()&&($rs.setAttr(g.settings(),"title",rspkr.c.decodeEntities(j.settings)),h(g.settings(),rspkr.c.decodeEntities(j.settings)));g.dl()&&($rs.setAttr(g.dl(),"title",rspkr.c.decodeEntities(j.download)),h(g.dl(),rspkr.c.decodeEntities(j.download)));if(g.powered()){var m=$rs.findIn(g.powered(),".rsbtn_btnlabel"),q=j.speechenabled.match(/.*href="([^"]*)"/i).pop(),v=j.newwindow,t=
document.createElement("p");t.innerHTML=j.speechenabled;v=(t.innerText||t.textContent)+(v?" ("+v+")":"");m&&(m.innerHTML=j.speechenabled);$rs.setAttr(g.powered(),"title",v);$rs.setAttr(g.powered(),"data-readspeaker-href",q);m=$rs.getAttr(g.powered(),"data-rsevent-id");(!m||rs.l.f.eq.store[m]&&!rs.l.f.eq.store[m].click)&&$rs.regEvent(g.powered(),"click",function(){window.open($rs.getAttr(this,"data-readspeaker-href"))})}g.closer()&&($rs.setAttr(g.closer(),"title",rspkr.c.decodeEntities(j.closeplayer)),
h(g.closer(),rspkr.c.decodeEntities(j.closeplayer)))}j=rspkr.c.data.browser;(!/safari/i.test(j.name)||!/iphone|ipad|ios/i.test(j.OS))&&$rs.addClass(a,"rs-no-touch");j=$rs.findIn(a,".rsbtn_status_overlay");$rs.isArray(j)||$rs.css(j,"display","none");"fallback"===rspkr.pl.adapter&&(rspkr.ui.showOverlay("nosound",a),$rs.addClass(a,"rsstopped"));$rs.addClass(a,"rsexpanded");if(rspkr.basicMode){var y;(y=$rs.findIn(a,".rsbtn_play"))&&$rs.addClass(y,"rsexpanded")}!p&&!f&&(g.stop()&&($rs.regEvent(g.stop(),
"click",function(a){b(a);n.stop()}),ui.addFocusHandler(g.stop())),g.pause()&&($rs.regEvent(g.pause(),"click",function(c){b(c);$rs.hasClass(a,"rsplaying")?n.pause():($rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rspaused"))&&n.play()}),ui.addFocusHandler(g.pause())),g.closer()&&($rs.regEvent(g.closer(),"click",function(a){b(a);n.close()}),ui.addFocusHandler(g.closer())),g.vol()&&($rs.regEvent(g.vol(),"click",function(a){b(a);n.vol(a)}),ui.addFocusHandler(g.vol())),g.dl()&&($rs.regEvent(g.dl(),"click",
function(a){b(a);return n.dl(a)}),ui.addFocusHandler(g.dl())),g.settings()&&($rs.regEvent(g.settings(),"click",function(a){b(a);n.settings()}),ui.addFocusHandler(g.settings())),g.pin()&&($rs.regEvent(g.pin(),"click",function(a){b(a);n.pin()}),ui.addFocusHandler(g.pin())),y=rspkr.cfg,$rs.setAttr(a,"data-readspeaker-current",0),$rs.setAttr(a,"data-readspeaker-buffered",0),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_progress_container"))||(l.progress=new rspkr.ui.Slider,l.progress.init($rs.findIn($rs.get(a),
".rsbtn_progress_container"),{handleClass:y.item("ui.progressHandleClass")||"rsbtn_progress_handle rsimg",dir:y.item("ui.progressDir")||"h",nudge:5,start:w,dragging:r,click:u,labelDragHandle:y.getPhrase("sliderseek")}),f=$rs.findIn($rs.get(a),".rsbtn_progress_handle a"),ui.addFocusHandler(f,!1,f.parentNode)),$rs.isArray($rs.findIn($rs.get(a),".rsbtn_volume_slider"))||(f=rspkr.st.get("hlvol")||"100",f=5*(parseInt(f)/100),l.vol=new rspkr.ui.Slider,l.vol.init($rs.findIn(a,".rsbtn_volume_slider"),{handleClass:y.item("ui.volumeHandleClass")||
"rsbtn_volume_handle rsimg",dir:y.item("ui.volumeDir")||"v",steps:5,nudge:1,initval:f,dragging:x,click:x,labelDragHandle:y.getPhrase("slidervolumedesc")}),f=$rs.findIn($rs.get(a),".rsbtn_volume_handle a"),ui.addFocusHandler(f,!1,f.parentNode)),rspkr.Common.addEvent("onFocusIn",z),rspkr.Common.addEvent("onFocusOut",B),rspkr.cfg.execCallback("cb.ui.open",a),p=!0);if($rs.findIn(a,".rsbtn_powered")&&(y=$rs.findIn(a,".rsbtn_powered .rsbtn_btnlabel a")))(/Chrome|Safari|Opera/gi.test(rs.c.data.browser.name)||
/Explorer/gi.test(rs.c.data.browser.name)&&8<=rs.c.data.browser.version)&&$rs.regEvent(y,"click",function(a){b(a)}),y.innerHTML='<span class="rsbtn_label_read">Read</span><span class="rsbtn_label_speaker">Speaker</span><span class="rsbtn_label_icon rsimg"></span>';"0"!=$rs.getAttr(a,"data-readspeaker-current")&&(rspkr.pl.releaseAdapter(),$rs.setAttr(a,"data-readspeaker-current",0));"fallback"!==rspkr.pl.adapter&&!e?(n.play(),rspkr.ui.focus(g.pause())):(l.progress&&l.progress.disabled(!0),n.setStateClass(a,
"rsstopped"),$rs.removeClass($rs.findIn(a,".rsbtn_progress_container"),"rsloading"),rspkr.basicMode&&n.setStateClass($rs.findIn(a,".rsbtn_exp"),"rsstopped"));e=(e=a)||a;e=$rs.clone(e,!0,!0);e.id=rspkr.getID();document.body.appendChild(e);$rs.css(e,{position:"absolute",top:"0",left:"0",display:"block",width:"auto"});$rs.css(e,"float","none");$rs.addClass(e,"rsexpanded");y=$rs.outerWidth(e)+3;e.style.display="none";document.body.removeChild(e);k=y;isNaN(k)||$rs.css(a,"width",k+(/[Ee]xplorer/.test(ReadSpeaker.c.data.browser.name)?
1:0)+"px");$rs.hasClass(a,"rspopup")&&(!rspkr.cfg.item("ui.pinnedPopup")&&!rspkr.basicMode)&&n.pin(!1,!0)},close:function(a){n.close(a)},stop:function(){n.stop()},nosound:function(){return n.nosound()},pause:function(){n.pause()},play:function(){n.play()},dl:function(a){n.dl(a)},settings:function(){n.settings()},vol:function(a){n.vol(a)},pin:function(a,b){n.pin(a,b)},restart:function(){rspkr.log("[rspkr.ui.restart]");n.stop();window.setTimeout(function(){n.play()},500);return!1},updateProgress:function(a){q(a)},
setProgress:function(a){r(a)},getContainer:function(){return a},getID:function(){return c},getWidth:function(){return k},setHref:function(a){j=a},getHref:function(){return j}}};
ReadSpeaker.ui.Lightbox=function(){var a=null,b=null,c=null,h=null,e=null,k=null,p,j=[],f=function(a){a=a||window.event;a.returnValue=!1;if(a=a.originalEvent)a.cancelBubble=!0,a.returnValue=!1;a&&a.preventDefault&&a.preventDefault();a&&a.stopPropagation&&a.stopPropagation()},g=function(){var a=$rs.css(k,"display");$rs.css(k,"display","none");var b=$rs.height(window),c=$rs.height(document),f=parseInt($rs.css(document.documentElement,"width")),g=$rs.width(document),h=$rs.absOffset(document.body),j=
0,l=0;isNaN(f)&&(f=$rs.width(window));h.left&&(l=h.left);h.top&&(j=h.top);$rs.css(e,{width:(g>f?g:f)+"px",height:(c>b?c:b)+"px",top:"-"+Math.abs(j)+"px",left:"-"+Math.abs(l)+"px"});$rs.css(k,"display",a);m()},m=function(){var a=$rs.outerWidth(k),b=$rs.outerHeight(k),c=$rs.width(window),e=$rs.height(window),b=p+80+50<e?p+80:e-50;k.style.height=b+"px";$rs.get("#rslightbox_content").style.height=b-80+"px";b>e?(k.style.top=$rs.scrollTop(document)+"px",k.style.marginTop="10px"):(k.style.top=e/2+"px",k.style.marginTop=
-(b/2-$rs.scrollTop(document))+"px");a>c?(k.style.left=$rs.scrollLeft(document)+"px",k.style.marginLeft="0"):(k.style.left="50%",k.style.marginLeft=-(a/2-$rs.scrollLeft(document))+"px")},l=function(a){27===a.keyCode&&rspkr.ui.Lightbox.hide()};return{init:function(){var e=rspkr.pub.Config;a=e.item("ui.overlay.overlayStyles");b=e.item("ui.overlay.contentStyles");c=e.item("ui.overlay.contentTemplate");document.querySelectorAll||(d=document,s=d.createStyleSheet(),d.querySelectorAll=function(a,b,c,e,f){f=
d.all;b=[];a=a.replace(/\[for\b/gi,"[htmlFor").split(",");for(c=a.length;c--;){s.addRule(a[c],"k:v");for(e=f.length;e--;)f[e].currentStyle.k&&b.push(f[e]);s.removeRule(0)}return b});rspkr.log("[rspkr.ui.Lightbox] Heartbeat!")},show:function(n,m,q,t,w){for(var r=0,u=document.body.getElementsByTagName("*"),x;x=u[r];r++)-1!=x.tabIndex&&(j.push([x,x.tabIndex]),x.tabIndex=-1);if(!("Explorer"==rs.c.data.browser.name&&6==rs.c.data.browser.version)){x=document.querySelectorAll("body > *");for(r=0;u=x[r];r++)if(!("rslightbox_overlay"==
u.id||"rslightbox_contentcontainer"==u.id||"script"==u.tagName.toLowerCase())){var z=u.getAttribute("aria-hidden");z&&u.setAttribute("data-original-aria-hidden",z);u.setAttribute("aria-hidden","true")}}n=n||"";q=q||!1;e?(e.style.display="",k.style.display=""):(e=document.createElement("div"),e.id="rslightbox_overlay",k=document.createElement("div"),k.id="rslightbox_contentcontainer",k.innerHTML=rspkr.st.r().replaceTokens(c.join("\n"),{rsLIGHTBOX_CLOSE_LABELrs:rspkr.cfg.getPhrase("close")}),$rs.setAttr(e,
"style",a.join(";")),$rs.setAttr(k,"style",b.join(";")),document.body.appendChild(e),document.body.appendChild(k),rspkr.evt("onSettingsLoaded",{func:rspkr.st.r().handlers.changed.addButtonEvents,context:rspkr.st.r().handlers.changed,params:[this]}));r=$rs.get("rslightbox_closer");rspkr.ui.addFocusHandler(r,!1);$rs.regEvent(r,"click",function(a){f(a);rspkr.ui.Lightbox.hide(a)});$rs.regEvent(e,"click",rspkr.ui.Lightbox.hide);$rs.regEvent(document.body,"keyup",l);if((u=document.documentElement)&&document.all)u.style.overflowX=
u.style.overflowY="hidden";if(n!=h||q)q=rspkr.cfg.getPhrase("close"),$rs.setAttr(r,"title",q),$rs.findIn(r,".rsbtn_btnlabel").innerHTML=q,$rs.get("#rslightbox_content").innerHTML="",$rs.css("#rslightbox_content","height","auto"),/^http/i.test(n)?$rs.findIn("#rslightbox_content","iframe").length||(q=document.createElement("iframe"),q.src=n,q.className="rslightbox-iframe",q.setAttribute("sandbox",""),void 0===w&&(w=2E3),$rs.get("#rslightbox_content").appendChild(q)):"<"==n.substr(0,1)&&($rs.get("#rslightbox_content").innerHTML=
n),$rs.get("#rslightbox_buttons").innerHTML=m,h=n,"ar_ar"==rs.c.data.params.lang&&(-1==k.className.indexOf("rtl")&&(k.className=(k.className+" rtl").replace(/^\s+|\s+$/g,"")),$rs.setAttr($rs.findIn(k,"legend"),"align","right"));p=void 0!==w&&!isNaN(w)?w:!rspkr.basicMode?$rs.get("#rslightbox_content").clientHeight:$rs.get("#rslightbox_content").scrollHeight;n=$rs.findIn("#rslightbox_content",".rsform-row");for(r=0;r<n.length;r++){m=$rs.findIn(n[r],"input, a, select");$rs.isArray(m)||(m=[m]);for(u=
0;u<m.length;u++)rspkr.ui.addFocusHandler(m[u],!1,n[r])}var B=$rs.findIn("#rslightbox_buttons",".rssettings-button-close");rspkr.ui.addFocusHandler(B,!1);$rs.regEvent(B,"click",function(a){f(a)});(n=$rs.findIn("#rsform_wrapper",".rssettings-button-gotobottom"))&&!$rs.isArray(n)&&rspkr.ui.addFocusHandler(n,!1);(n=$rs.findIn("#rslightbox_buttons",".rssettings-button-gototop"))&&!$rs.isArray(n)&&rspkr.ui.addFocusHandler(n,!1);var A=$rs.findIn("#rslightbox_content","input");$rs.isArray(A)&&0<A.length?
setTimeout(function(){rspkr.ui.focus(A[0]);rspkr.Common.addEvent("onFocusIn",function(a){a.className&&$rs.hasClass(a,"rssettings-button-gototop")?rspkr.ui.focus(A[0]):a.className&&$rs.hasClass(a,"rssettings-button-gotobottom")&&rspkr.ui.focus(B)})},200):$rs.isArray(A)||setTimeout(function(){rspkr.ui.focus(A)},200);g();$rs.regEvent(window.document.documentElement,"resize",g);"function"==typeof t&&t.apply(this,[k])},hide:function(a){for(;0<j.length;){var b=j.pop();b[0].tabIndex=b[1]}if(!("Explorer"==
rs.c.data.browser.name&&6==rs.c.data.browser.version))for(var a=document.querySelectorAll("body > *"),b=0,c;c=a[b];b++){var h=c.getAttribute("data-original-aria-hidden");h?(c.setAttribute("aria-hidden",h),c.removeAttribute("data-original-aria-hidden")):c.removeAttribute("aria-hidden")}f(a);e.style.display="none";k.style.display="none";$rs.unregEvent(window,"resize",g);$rs.unregEvent($rs.get("#rslightbox_closer"),"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(e,"click",rspkr.ui.Lightbox.hide);$rs.unregEvent(document.body,
"keyup",l);if((a=document.documentElement)&&document.all)a.style.overflowX=a.style.overflowY="auto";rspkr.ui.updateFocus();rspkr.c.dispatchEvent("onSettingsClosed",window,[])},reposition:m}}();
ReadSpeaker.q(function(){var a=ReadSpeaker.HL,b="Explorer"==ReadSpeaker.c.data.browser.name&&8>ReadSpeaker.c.data.browser.version,c=void 0,h=function(){c||(c=document.createElement("div"),c.id="rs_enlargeHL_box",b&&(c.className="rs_enlargeHL_legacy"),e(),document.body.appendChild(c));c.style.display="block"},e=function(){c&&(c.style.backgroundColor=ReadSpeaker.Common.Settings.get("hlsent"),c.style.color=ReadSpeaker.Common.Settings.get("hltext"))},k=function(a,b){var e=a.text?a.text:a.innerHTML;if(/\S/.test(e)){ReadSpeaker.log("_sentHL ("+
b+"): "+e,5);h();var f,j="";a.previousSibling?f=a.previousSibling:a.parentElement&&a.parentElement.previousSibling&&(f=a.parentElement.previousSibling);f&&3===f.nodeType&&f.textContent&&f.textContent.length&&!/\S/.test(f.textContent)&&(j=" ");c.innerHTML=1==b?c.innerHTML+j+e:e;e=c.getElementsByTagName(ReadSpeaker.Common.data.browser.syncContainer);for(f=0;f<e.length;f++)/^custom_/.test(e[f].id)||(e[f].id="custom_"+e[f].id)}},p=function(a,b){var e=a.text?a.text:a.innerHTML;if(/\S/.test(e)){ReadSpeaker.log("_wordHL ("+
b+"): "+e,5);h();1!=b&&$rs.removeClass($rs.findIn(c,".sync_word_highlighted"),"sync_word_highlighted");var f=$rs.findIn(c,"#custom_"+a.id);if($rs.isArray(f))if(f=a,a.innerHTML){for(;f.parentNode;){if(/\bsync_sent|ffsent/.test(f.parentNode.className)){ReadSpeaker.log("---\> Remitting to _sentHL",5);k(f.parentNode);p(a,b);return}f=f.parentNode}c.innerHTML=a.innerHTML;$rs.findIn(c,a.id).id="custom_"+a.id;p(a,b)}else c.innerHTML=e;else $rs.addClass(f,"sync_word_highlighted")}},j=function(){c&&(c.style.display=
"none",c.innerHTML="")};ReadSpeaker.c.addEvent("onSettingsChanged",function(){e();"enlargeoff"===rs.st.get("enlarge")&&j()});var f=rs.cfg.getSettingsConf();f.highlighting&&f.highlighting.items&&(f.highlighting.items.enlarge={phrase:"ph_hlenlarge",type:"radio",info:"ph_hlenlargeinfo",options:[{value:"enlargeon",phrase:"ph_on"},{value:"enlargeoff",phrase:"ph_off"}]});a.customHL={active:function(){return"enlargeon"===ReadSpeaker.st.get("enlarge")},sentHL:k,wordHL:p,cleanUp:j}});
ReadSpeaker.q(function(){var a={en_us:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},en_uk:{hlenlarge:"Enhanced text visibility",hlenlargeinfo:"Displays the current sentence at the bottom of the page, with a larger font size and simultaneous text highlighting."},ar_ar:{hlenlarge:decodeURIComponent("%D8%AA%D8%B9%D8%B2%D9%8A%D8%B2%20%D8%B1%D8%A4%D9%8A%D8%A9%20%D8%A7%D9%84%D9%86%D8%B5"),
hlenlargeinfo:decodeURIComponent("%D9%8A%D8%B9%D8%B1%D8%B6%20%D8%A7%D9%84%D8%AC%D9%85%D9%84%D8%A9%20%D8%A7%D9%84%D8%AD%D8%A7%D9%84%D9%8A%D8%A9%20%D8%A8%D8%AF%D8%A7%D8%AE%D9%84%20%D9%85%D8%B1%D8%A8%D8%B9%20%D9%81%D9%8A%20%D8%A7%D9%84%D8%AC%D8%B2%D8%A1%20%D8%A7%D9%84%D8%B3%D9%81%D9%84%D9%8A%20%D9%85%D9%86%20%D8%A7%D9%84%D8%B5%D9%81%D8%AD%D8%A9%D8%8C%20%D8%A8%D8%B9%D8%AF%20%D8%AA%D9%83%D8%A8%D9%8A%D8%B1%D8%AD%D8%AC%D9%85%20%D8%A7%D9%84%D8%AE%D8%B7%20%D9%88%D8%A3%D8%AB%D9%86%D8%A7%D8%A1%20%D8%A7%D8%A8%D8%B1%D8%A7%D8%B2%20%D8%A7%D9%84%D9%86%D8%B5%20%D9%88%D8%A8%D8%B4%D9%83%D9%84%20%D9%85%D8%AA%D8%B2%D8%A7%D9%85%D9%86.")},
ca_es:{hlenlarge:"Visibilitat de text millorat",hlenlargeinfo:decodeURIComponent("Mostra%20la%20frase%20actual%20en%20un%20quadre%20a%20la%20part%20inferior%20de%20la%20p%C3%A0gina%2C%20amb%20una%20mida%20de%20lletra%20m%C3%A9s%20gran%20i%20ressaltat%20de%20text%20simult%C3%A0nia")},cs_cz:{hlenlarge:decodeURIComponent("Zv%C4%9Bt%C5%A1en%C3%AD%20textu"),hlenlargeinfo:decodeURIComponent("Zobrazuje%20pr%C3%A1v%C4%9B%20%C4%8Dtenou%20v%C4%9Btu%20jako%20zv%C4%9Bt%C5%A1en%C3%BD%20text%20v%20samostatn%C3%A9m%20okn%C4%9B%20dole%20na%20str%C3%A1nce.")},
cy_cy:{hlenlarge:"Gwelededd testun gwell",hlenlargeinfo:decodeURIComponent("Dangos%20y%20frawddeg%20sy%E2%80%99n%20cael%20ei%20ddarllen%20yn%20gyfredol%20gyda%20thestun%20bras%20mewn%20blwch%20testun%20ar%20wah%C3%A2n%20wrth%20waelod%20y%20tudalen.")},da_dk:{hlenlarge:decodeURIComponent("Forst%C3%B8rret%20tekstvisning"),hlenlargeinfo:decodeURIComponent("Viser%20den%20aktuelt%20opl%C3%A6ste%20s%C3%A6tning%20med%20forst%C3%B8rret%20skrift%20i%20en%20separat%20tekstboks%20nederst%20p%C3%A5%20siden.")},
de_de:{hlenlarge:"Verbesserte Text-Sichtbarkeit",hlenlargeinfo:decodeURIComponent("Zeigt%20den%20aktuell%20vorgelesenen%20Satz%20in%20einer%20Textbox%20am%20unteren%20Ende%20der%20Seite%20an%2C%20mit%20vergr%C3%B6%C3%9Ferter%20Schrift%20und%20gleichzeitiger%20Texthervorhebung")},es_es:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20actual%20en%20un%20cuadro%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina%2C%20con%20un%20tama%C3%B1o%20de%20letra%20m%C3%A1s%20grande%20y%20resaltado%20de%20texto%20simult%C3%A1nea")},
es_co:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20actual%20en%20un%20cuadro%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina%2C%20con%20un%20tama%C3%B1o%20de%20letra%20m%C3%A1s%20grande%20y%20resaltado%20de%20texto%20simult%C3%A1nea")},es_mx:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},
es_us:{hlenlarge:"Mejor visibilidad del texto",hlenlargeinfo:decodeURIComponent("Muestra%20la%20frase%20que%20se%20est%C3%A1%20leyendo%20actualmente%20con%20el%20texto%20ampliado%20en%20un%20cuadro%20de%20texto%20independiente%20en%20la%20parte%20inferior%20de%20la%20p%C3%A1gina.")},eu_es:{hlenlarge:"Hobetutako testu ikuspena",hlenlargeinfo:"Erakusten du gaur egun, orrialdeko behealdeko testu independenteko koadro batean handitutako testuaz irakurtzen ari den resalida."},fi_fi:{hlenlarge:decodeURIComponent("Parannettu%20tekstin%20n%C3%A4kyvyys"),
hlenlargeinfo:decodeURIComponent("N%C3%A4ytt%C3%A4%C3%A4%20lauseen%20suurennettuna%20ja%20samanaikaisesti%20korostettuna%2C%20sivun%20alaosassa%20olevassa%20ruudussa")},fo_fo:{hlenlarge:decodeURIComponent("St%C3%B8rri%20tekstv%C3%ADsing"),hlenlargeinfo:decodeURIComponent("V%C3%ADsir%20upplisna%20setningin%20vi%C3%B0%20st%C3%B8rri%20skriftst%C3%B8dd%20%C3%AD%20serligum%20r%C3%BAti%20ni%C3%B0ast%20%C3%A1%20s%C3%AD%C3%B0uni.")},fr_fr:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),
hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},fr_be:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},
fr_ca:{hlenlarge:decodeURIComponent("Visibilit%C3%A9%20du%20texte%20renforc%C3%A9e"),hlenlargeinfo:decodeURIComponent("Affiche%20la%20phrase%20courante%20au%20bas%20de%20la%20page%2C%20avec%20une%20police%20de%20plus%20grande%20taille%20et%20le%20texte%20en%20surbrillance%20simultan%C3%A9e")},gl_es:{hlenlarge:"Mellora da visibilidade do texto",hlenlargeinfo:decodeURIComponent("Amosa%20a%20frase%20actual%20nun%20recadro%20na%20parte%20inferior%20da%20p%C3%A1xina%2C%20cunha%20letra%20m%C3%A1is%20grande%20e%20%C3%A1%20vez%20resaltando%20o%20texto.")},
hu_hu:{hlenlarge:decodeURIComponent("Megjelen%C3%ADt%C3%A9s%20l%C3%A1that%C3%B3bb%C3%A1%20t%C3%A9tele"),hlenlargeinfo:decodeURIComponent("A%20felolvas%C3%A1ssal%20egy%20id%C5%91ben%20nagyobb%20bet%C5%B1m%C3%A9ret%C5%B1%2C%20kiemelt%20sz%C3%B6veg%20jelenik%20meg%20az%20oldal%20alj%C3%A1n%20egy%20k%C3%BCl%C3%B6n%20ablakban.")},it_it:{hlenlarge:decodeURIComponent("Visibilit%C3%A0%20testo%20accentuata"),hlenlargeinfo:"Visualizza la frase corrente in un box di grandi dimensioni a fondo pagina utilizzando un font molto grande ed evidenziando il testo in sincrono con la lettura"},
ja_jp:{hlenlarge:decodeURIComponent("%E6%96%87%E5%AD%97%E3%81%AE%E6%8B%A1%E5%A4%A7%E8%A1%A8%E7%A4%BA"),hlenlargeinfo:decodeURIComponent("%E8%AA%AD%E3%81%BF%E4%B8%8A%E3%81%92%E3%82%8B%E6%96%87%E7%AB%A0%E3%82%92%E3%83%9A%E3%83%BC%E3%82%B8%E4%B8%8B%E9%83%A8%E3%81%AB%E3%83%8F%E3%82%A4%E3%83%A9%E3%82%A4%E3%83%88%E3%81%97%E3%81%AA%E3%81%8C%E3%82%89%E6%8B%A1%E5%A4%A7%E6%96%87%E5%AD%97%E3%81%A7%E8%A1%A8%E7%A4%BA%E3%81%99%E3%82%8B")},ko_kr:{hlenlarge:decodeURIComponent("%ED%96%A5%EC%83%81%EB%90%9C%20%EA%B8%80%EC%9E%90%20%ED%91%9C%EC%8B%9C"),
hlenlargeinfo:decodeURIComponent("%ED%8E%98%EC%9D%B4%EC%A7%80%20%ED%95%98%EB%8B%A8%EC%9D%98%20%EB%B0%95%EC%8A%A4%20%EC%95%88%EC%97%90%20%EC%9E%88%EB%8A%94%20%ED%98%84%EC%9E%AC%20%EB%AC%B8%EC%9E%A5%EC%9D%84%20%EB%B3%B4%EB%8B%A4%20%ED%81%B0%20%ED%8F%B0%ED%8A%B8%20%EC%82%AC%EC%9D%B4%EC%A6%88%EC%99%80%20%EB%8F%99%EC%8B%9C%20%EA%B8%80%EC%9E%90%20%EA%B0%95%EC%A1%B0%ED%95%98%EA%B8%B0%EB%A1%9C%20%ED%91%9C%EC%8B%9C%ED%95%A9%EB%8B%88%EB%8B%A4.")},nl_nl:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},
nl_be:{hlenlarge:"Tekstvergroting",hlenlargeinfo:"Toont de zin die voorgelezen wordt in een apart venster onderaan de pagina, met een grotere lettergrootte en gelijktijdige tekstmarkering."},fy_nl:{hlenlarge:"Ferbettere sichtberheid fan de tekst",hlenlargeinfo:decodeURIComponent("Lit%20de%20sin%20dy%E2%80%99t%20jo%20op%20dit%20stuit%20l%C3%AAze%20%C3%BAtfergrutte%20sjen%20yn%20in%20aparte%20tekst%20%C3%BBnder%20oan%20de%20side.")},is_is:{hlenlarge:decodeURIComponent("Aukin%20texta%20st%C3%A6kkun"),
hlenlargeinfo:decodeURIComponent("S%C3%BDna%20einnig%20ne%C3%B0st%20%C3%A1%20s%C3%AD%C3%B0unni%20setninguna%20sem%20veri%C3%B0%20er%20a%C3%B0%20lesa%2C%20me%C3%B0%20st%C3%A6rra%20letri%20og%20upplitun%20me%C3%B0%20lestrinum.")},no_nb:{hlenlarge:decodeURIComponent("%C3%98kt%20tekstsynlighet"),hlenlargeinfo:decodeURIComponent("Viser%20setningen%20nederst%20p%C3%A5%20siden%2C%20med%20st%C3%B8rre%20skriftst%C3%B8rrelse%20og%20tekstmerking%20mens%20den%20leses%20opp")},no_nn:{hlenlarge:"Auka tekstsynlegheit",
hlenlargeinfo:decodeURIComponent("Setninga%20som%20vert%20lese%20visast%20nederst%20p%C3%A5%20sida%20i%20ein%20eigen%20tekstboks%20med%20forst%C3%B8rra%20skrift.")},pl_pl:{hlenlarge:decodeURIComponent("Widoczno%C5%9B%C4%87%20wyr%C3%B3%C5%BCnionego%20tekstu"),hlenlargeinfo:decodeURIComponent("Wy%C5%9Bwietlaj%20zdanie%2C%20kt%C3%B3re%20jest%20aktualnie%20czytane%20z%20powi%C4%99kszonym%20tekstem%20w%20osobnym%20polu%20na%20dole%20strony.")},pt_pt:{hlenlarge:"Melhorar a visibilidade",hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},
pt_br:{hlenlarge:"Melhorar a visibilidade",hlenlargeinfo:decodeURIComponent("A%20frase%20%C3%A9%20exibida%20numa%20caixa%2C%20na%20parte%20inferior%20da%20p%C3%A1gina%2C%20com%20um%20tamanho%20maior%20de%20fonte%20e%20o%20texto%20a%20ser%20destacado%20em%20simult%C3%A2neo%20com%20a%20leitura")},ru_ru:{hlenlarge:decodeURIComponent("%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B8%D1%82%D1%8C%20%D1%82%D0%B5%D0%BA%D1%81%D1%82"),hlenlargeinfo:decodeURIComponent("%D0%9F%D1%80%D0%BE%D0%B8%D0%B7%D0%BD%D0%BE%D1%81%D0%B8%D0%BC%D0%BE%D0%B5%20%D0%BF%D1%80%D0%B5%D0%B4%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5%20%D0%BF%D0%BE%D0%BA%D0%B0%D0%B7%D1%8B%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F%20%D1%83%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%BD%D1%8B%D0%BC%20%D1%82%D0%B5%D0%BA%D1%81%D1%82%D0%BE%D0%BC%20%D0%B2%20%D0%BE%D1%82%D0%B4%D0%B5%D0%BB%D1%8C%D0%BD%D0%BE%D0%BC%20%D0%BE%D0%BA%D0%BD%D0%B5%20%D0%B2%20%D0%BD%D0%B8%D0%B6%D0%BD%D0%B5%D0%B9%20%D1%87%D0%B0%D1%81%D1%82%D0%B8%20%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D1%8B.")},
sv_se:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},sv_fi:{hlenlarge:decodeURIComponent("F%C3%B6rstorad%20text"),hlenlargeinfo:decodeURIComponent("Visar%20meningen%20som%20l%C3%A4ses%20l%C3%A4ngst%20ner%20p%C3%A5%20sidan%2C%20med%20st%C3%B6rre%20typsnitt%20och%20textmarkering.")},tr_tr:{hlenlarge:decodeURIComponent("Geli%C5%9Fmi%C5%9F%20metin%20g%C3%B6r%C3%BCn%C3%BCrl%C3%BC%C4%9F%C3%BC"),
hlenlargeinfo:decodeURIComponent("Ge%C3%A7erli%20c%C3%BCmleyi%20sayfan%C4%B1n%20alt%C4%B1nda%20bir%20kutuda%20daha%20b%C3%BCy%C3%BCk%20yaz%C4%B1%20tipi%20boyutuyla%20ve%20e%C5%9Fzamanl%C4%B1%20metin%20vurgulama%20ile%20g%C3%B6r%C3%BCnt%C3%BCler.")},zh_cn:{hlenlarge:decodeURIComponent("%E5%A2%9E%E5%BC%BA%E6%96%87%E6%9C%AC%E5%8F%AF%E8%A7%81%E6%80%A7"),hlenlargeinfo:decodeURIComponent("%E5%9C%A8%E9%A1%B5%E9%9D%A2%E5%BA%95%E9%83%A8%E6%98%BE%E7%A4%BA%E5%BD%93%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E5%8F%A5%E5%AD%90%E5%AD%97%E4%BD%93%E7%A8%8D%E5%A4%A7%E4%B8%94%E5%90%8C%E6%AD%A5%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%96%87%E6%9C%AC%E3%80%82")},
zh_hk:{hlenlarge:decodeURIComponent("%E6%8F%90%E9%AB%98%E6%96%87%E5%AD%97%E5%8F%AF%E8%A6%96%E5%BA%A6"),hlenlargeinfo:decodeURIComponent("%E8%AB%8B%E5%9C%A8%E9%A0%81%E9%9D%A2%E5%BA%95%E9%83%A8%E6%96%B9%E6%A1%86%E4%B8%AD%E9%A1%AF%E7%A4%BA%E7%95%B6%E5%89%8D%E5%8F%A5%E5%AD%90%EF%BC%8C%E6%96%87%E5%AD%97%E5%B0%87%E4%BB%A5%E5%A4%A7%E8%99%9F%E5%AD%97%E9%AB%94%E4%BB%A5%E5%8F%8A%E5%90%8C%E6%AD%A5%E6%96%87%E5%AD%97%E7%AA%81%E5%87%BA%E9%A1%AF%E7%A4%BA%E3%80%82")}};ReadSpeaker.cfg.extendPhrases(a);rs.st.get("enlarge")||
ReadSpeaker.cfg.item("settings.enlarge","enlargeoff");rs.cfg.defaultsettings&&(rs.cfg.defaultsettings.enlarge="enlargeoff")});
